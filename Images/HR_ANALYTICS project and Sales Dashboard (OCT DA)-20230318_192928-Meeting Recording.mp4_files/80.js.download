(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[80],{267:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(21),i=n(212),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.noRedirect,s=t.dataRequestorType,c=void 0===s?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r,noRedirect:o})||this}return Object(a.__extends)(t,e),t}(i.t):s,d=e.dataSourceName,l=void 0===d?"DataSource":d;this.dataRequestor=new c({qosName:l})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_){void 0===i&&(i="POST");var h=e(),b=a&&a(),g=this.needsRequestDigest(h);return this.dataRequestor.getData({url:h,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:g,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_})},e}();t.t=r},576:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.docset=1]="docset",e[e.folder=2]="folder",e[e.genericFile=3]="genericFile",e[e.listItem=4]="listItem",e[e.sharedFolder=5]="sharedFolder",e[e.multiple=6]="multiple",e[e.stream=7]="stream",e[e.news=8]="news",e[e.desktopFolder=9]="desktopFolder",e[e.documentsFolder=10]="documentsFolder",e[e.picturesFolder=11]="picturesFolder",e[e.linkedFolder=12]="linkedFolder",e[e.list=13]="list",e[e.form=14]="form",e[e.sway=15]="sway",e[e.playlist=16]="playlist"}(a||(a={}))},579:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=3e5,i=864e5,r="odsp-ds-",o={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4}},686:function(e,t,n){"use strict";var a=n(1059),i=function(){function e(){}return e.prototype.debounce=function(e){var t=this;this.clear(),this._originalPromise=e;var n=new a.e(function(){return t._originalPromise.cancel()});return this._originalPromise.done(function(e){t._clear(!1),n.complete(e)},function(e){t._clear(!1),n.error(e)}),n.getPromise()},e.prototype.clear=function(){this._clear(!0)},e.prototype.isExecuting=function(){return Boolean(this._originalPromise)},e.prototype._clear=function(e){this.isExecuting()&&(e&&this._originalPromise.cancel(),this._originalPromise=null)},e}();t.e=i},710:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(354),i=n(481),r=n(122);function o(e,t){void 0===t&&(t={});var n=e.channelId,o=e.onReinitialize,s=e.origin,c=e.receiver,d=void 0===c?window:c,l=e.source,u=e.identifyParent,f=t.eventGroupType,p=void 0===f?a.e:f,m=t.messengerType,_=void 0===m?i.e:m,h=new r.e,b=h.attach(new p(null));return new _({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var a;if(u&&l){var i=setInterval(function(){var e={type:"identify-parent",channelId:n};l.postMessage(e,s)},100);a=h.attach({dispose:function(){clearInterval(i)}})}var r=!1;b.on(d,"message",function(t){var i=t.data;if(t.origin===s&&(!l||t.source===l)&&i&&"object"==typeof i&&"initialize"===i.type&&i.channelId===n){if(a&&a.dispose(),o){if(r)return o(),void b.dispose();r=!0}else b.dispose();var c=i.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}},821:function(e,t,n){"use strict";n.d(t,"e",function(){return V});var a={};n.r(a),n.d(a,"localStorage",function(){return c}),n.d(a,"indexedDB",function(){return d}),n.d(a,"none",function(){return l});var i,r=n(21),o=n(756),s=n(2),c=0,d=1,l=2,u=a,f=n(142),p=n(3),m="undefined"==typeof window?self:window,_=n(70);!function(e){e.success="success",e.error="error"}(i||(i={}));var h="app",b="app_lastRead",g="ODSP_DB",v="ODSP_DB_TABLE",y="lastModified",S="lastRead",D="ODSP_DB_METADATA_TABLE",I="database_metadata",x="parentKey",C="reads",O=(new f.e).isFirefox,w="indexedDB is not supported",E=function(){function e(t){if(!("indexedDB"in m)||!m.indexedDB)throw new Error(w);this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,o,s=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=a.transaction([v],"readwrite").objectStore(v).index(b).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this._readInternal(v,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,f,p,m,_,h=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n={},i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=a.transaction([v],"readonly"),c=s.objectStore(v),d=[],l=t.index,u=t.range,f=t.direction,p=t.count,m=c.index(l),(_=m.openKeyCursor(u,f)).onerror=function(e){h._errorHandling(e,n.reject)},_.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=p?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:v,key:t,row:Object(r.__assign)(Object(r.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:v,key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(v,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=O?indexedDB.open(g,{version:4,storage:"temporary"}):indexedDB.open(g,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(v,{keyPath:"key"})).createIndex(y,y,{unique:!1}),a.createIndex(C,C,{unique:!1}),t.createObjectStore(D,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(v)).createIndex(h,h,{unique:!1}),a.createIndex(S,S,{unique:!1}),a.createIndex(b,[h,S],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(v)).createIndex("app_lastModified",[h,y],{unique:!1}),a.createIndex("app_reads",[h,C],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(v)).createIndex(x,x,{unique:!1}),a.createIndex("parentKey_app",[x,h],{unique:!1}),a.createIndex("parentKey_app_lastModified",[x,h,y],{unique:!1}),a.createIndex("parentKey_app_lastRead",[x,h,S],{unique:!1}),a.createIndex("parentKey_app_reads",[x,h,C],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(D,function(e){return e.get(I)}).then(function(t){if(t)return t.data;var n={id:p.generate(),created:Date.now(),cacheType:u.indexedDB};return e._writeInternal({tableName:D,key:I,row:{key:I,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,o,s=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,[2,new Promise(function(e,i){var r=s._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),c=a.transaction([t],"readonly").objectStore(t),d=n(c);d.onsuccess=function(t){r({resultType:_.t.Success,extraData:{io:Math.round(Date.now()-o)}}),e(d.result)},d.onerror=function(e){r({resultType:_.t.Failure,extraData:{io:Math.round(Date.now()-o)}}),s._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,o,s,c=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=r.sent(),r.label=2;case 2:return a=i._db=o,s=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,c,d=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=t.tableName,a=t.key,i=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=r.sent(),r.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var r=o.transaction([n],"readwrite"),s=r.objectStore(n);r.oncomplete=function(){},r.onerror=function(e){d._errorHandling(e,t)};var c=i?s.put(i):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(r.__generator)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:x,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:v,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===i.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),A="PersistentCache",L="PersistentCache_metadata",k=function(){function e(){try{if("localStorage"in m&&m.localStorage&&(this._localStorage=m.localStorage,!this._localStorage.getItem(L))){var e={id:p.generate(),created:Date.now(),cacheType:u.localStorage};this._localStorage.setItem(L,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(r.__assign)(Object(r.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(A)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(L)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(A,"_").concat(e)},e}(),M=0,P=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return Object(r.__awaiter)(n,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:M++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=m.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function T(){return m.performance&&performance.now?Math.round(performance.now()):Date.now()}var U=n(84),F="_odspcache_",H="_____",R={cacheType:u.indexedDB},N=function(){function e(e){var t=e.cacheType,n=void 0===t?R.cacheType:t,a=Object(r.__rest)(e,["cacheType"]);if(this._config=Object(r.__assign)(Object(r.__assign)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new P,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=this._logQos({name:"PersistentCache.read"}),s=T(),c=Date.now(),r.label=1;case 1:return r.trys.push([1,12,,13]),l=this._getCacheKey(t),u=!1,f={lastModified:NaN,lastRead:c,reads:1},p=void 0,l?(m=T(),[4,this._storage.read(l)]):[3,11];case 2:return d=r.sent(),o=Math.round(T()-m),d?(_=d.data,f={lastModified:d.lastModified,lastRead:c,reads:d.reads+1},(a=e._buffer[l])&&a.cacheStats.lastModified===d.lastModified?(a.app=d.app||this._app,a.key={original:t,encoded:d.key||l},a.cacheStats.lastRead=c,a.cacheStats.reads++,a.performance={total:Math.round(T()-s)},[3,11]):[3,3]):[3,11];case 3:if(a=void 0,void 0===_)return[3,11];if(!this._dataIsEncrypted)return[3,10];h=_,b=this._cacheSecret,g=b.CurrentKey.Key,v=b.PreviousKey.Key,y=T(),r.label=4;case 4:return r.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:h,encryptionSecret:g})];case 5:return p=r.sent(),[3,9];case 6:return(S=r.sent())&&S.message&&S.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:h,encryptionSecret:v})]:[3,8];case 7:p=r.sent(),u=void 0!==p,n({resultType:U.e.ExpectedFailure,error:S.message,extraData:{cacheResult:"hit"}}),r.label=8;case 8:return[3,9];case 9:return i=Math.round(T()-y),[3,11];case 10:p=_,r.label=11;case 11:return a=a||{key:{original:t,encoded:d&&d.key||l},app:d&&d.app||this._app,data:p,cacheStats:f,cacheType:this._cacheType,performance:{crypto:i,io:o,total:Math.round(T()-s)}},e._buffer[l]=a,u&&this.update(t,p),[3,13];case 12:throw D=r.sent(),n({resultType:U.e.Failure,error:D.message?D.message:D.toString(),extraData:{cacheResult:"miss"}}),D;case 13:return n({resultType:U.e.Success,extraData:{cacheResult:"".concat(void 0!==a.data?"hit":"miss")}}),[2,Promise.resolve(a)]}})})},e.prototype.rangeQuery=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,o,s,c,d=this;return Object(r.__generator)(this,function(r){if(this._cacheType!==u.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=T(),i=Date.now(),s={lastModified:NaN,lastRead:i,reads:1};try{c=T(),o=this._storage.rangeQuery(e).then(function(e){return n=Math.round(T()-c),{key:void 0,app:void 0,data:e.map(function(e){return{original:d._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:s,cacheType:d._cacheType,performance:{io:n,total:Math.round(T()-a)}}})}catch(e){throw t({resultType:U.e.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:U.e.Success}),[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:s,cacheType:this._cacheType,performance:{io:n,total:Math.round(T()-a)}})]})})},e.prototype.update=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a=this;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return a._doCacheUpdate(e,t)}).signal.promise];case 1:return i.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,c,d=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=T(),a=Date.now(),i=this._logQos({name:"PersistentCache.readAndUpdate"}),o=t().then(function(t){var i={app:d._app,key:{original:e,encoded:d._getCacheKey(e)},data:t,cacheType:u.none,cacheStats:{lastModified:void 0,lastRead:a,reads:1},performance:{total:Math.round(T()-n)}};return d.update(e,t),i}),r.label=1;case 1:r.trys.push([1,8,,9]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Promise.race([this.read(e),o])];case 3:return s=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return!s||s.cacheType!==u.none&&void 0===s.data?[4,o]:[3,7];case 6:s=r.sent(),r.label=7;case 7:return[3,9];case 8:throw c=r.sent(),i({resultType:U.e.Failure,error:c.message?c.message:c.toString()}),c;case 9:return i({resultType:U.e.Success}),[2,s]}})})},e.prototype._initLocalStorage=function(e){if(e===u.localStorage)this._storage=new k;else try{this._storage=new E(this._logQos.bind(this))}catch(e){e.message===w&&(this._storage=new k,this._cacheType=u.localStorage)}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?H+e.user:""));return"".concat(F).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(F,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(H)>=0){var i=a.split(H);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._doCacheUpdate=function(t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,o,s,c,d,l;return Object(r.__generator)(this,function(f){switch(f.label){case 0:a=this._logQos({name:"PersistentCache.update"}),f.label=1;case 1:return f.trys.push([1,9,,10]),i=this._getCacheKey(t),void 0===n?[3,6]:((o=e._buffer[i]=Object(r.__assign)(Object(r.__assign)({},e._buffer[i]),{data:n,cacheType:this._cacheType})).cacheStats||(o.cacheStats={lastModified:NaN,lastRead:T(),reads:1}),s=n,c=NaN,this._dataIsEncrypted?(d=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:d,data:n,doSerialize:this._cacheType===u.localStorage})]):[3,3]);case 2:return s=f.sent(),c=s.cipherText?s.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}f.label=4;case 4:return[4,this._storage.write({app:this._app,key:i,data:s,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:c})];case 5:return f.sent(),[3,8];case 6:return delete e._buffer[i],[4,this._storage.write({key:i,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:throw l=f.sent(),a({resultType:U.e.Failure,error:l.message?l.message:l.toString()}),l;case 10:return a({resultType:U.e.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(r.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),B=n(579),j=!s.e.isActivated("32DD9EE9-56B8-4C7C-BC57-67F6BCAD585E","09/27/2022","Fix PersistentRequestCache to always clear cached promise once it resolves/rejects"),V=function(){function e(e,t){this._getDataPromises={};var n=e.id,a=e.dataSourceName,i=e.cacheType,o=void 0===i?u.indexedDB:i,s=(t.pageContext||{}).aadUserId;this._id=n,this._userId=s;var c=a||n,d=_.e.withData(function(e){return e.name&&c&&!e.name.startsWith(c)?Object(r.__assign)(Object(r.__assign)({},e),{name:"".concat(c,".").concat(e.name)}):e});this._cache=new N({cacheType:o,telemetry:{qos:d}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.cachingStrategy,r=void 0===i?B.e.useCacheAndUpdateInTheBackground:i,s=n.cacheTimeoutTime,c=void 0===s?B.a:s,d=n.getData,l=n.returnStatistics,u=void 0!==l&&l,f=n.cacheRequestParentKey,p={key:a,user:this._userId,parentKey:f},m=function(){if(j){var e=t._getDataPromises[a];return e||(e=t._getDataPromises[a]=d()).then(function(e){return t._cache.update(p,e),delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e}),e.then(function(e){return u?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})}return t._getDataPromises[a]||(t._getDataPromises[a]=d().then(function(e){return delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})),t._getDataPromises[a].then(function(e){return t._cache.update(p,e),u?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return r===B.e.onlyCache?o.t.resolve(this._cache.read(p)).then(function(e){var t=e||(j?{}:void 0),n=t.data,a=t.cacheStats;return null==n?null:u?{data:n,cacheStats:a}:n}).catch(function(){return null}):o.t.resolve(this._cache.read(p)).then(function(e){var n=e||(j?{}:void 0),a=n.data,i=n.cacheStats;if(null==a)return m();var o=u?{data:a,cacheStats:i}:a,s=t._isCacheExpired(i.lastModified,c);switch(r){case B.e.useCacheAndNoUpdate:return o;case B.e.useCacheAndUpdateInTheBackground:return s&&m(),o;case B.e.useCacheIfNotExpired:return s?m():o;case B.e.bypassCache:default:return m()}}).catch(function(){return m()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e],this._cache.remove(n)},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update(n,t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}()},903:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(7),i=n(503);function r(e,t){var n=Object(a.e)(e).id;return t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0),n}function o(e,t){var n=e;return 0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t})),n}},972:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notSupported=0]="notSupported",e[e.listsHome=1]="listsHome",e[e.sites=2]="sites",e[e.teams=3]="teams",e[e.siteHome=4]="siteHome",e[e.withListTemplate=5]="withListTemplate",e[e.withTemplatePreview=6]="withTemplatePreview",e[e.listsOnboarding=7]="listsOnboarding"}(a||(a={}))},990:function(e,t,n){"use strict";n.d(t,"e",function(){return de});var a=n(21),i=n("react-lib"),r=n(57),o=n(710),s=n(258),c=n(148),d=n(3),l=n(503),u=n(53);Object(u.n)([{rawString:".frame_799d2892{border:none;display:block}"}]);var f=n(70),p=n(173),m=n(748),_=n(100),h=n(759),b=n(226),g=n(2),v=n(1201),y=n(141),S=n(48),D=n(88),I=n(1244),x=n(67),C={all:{pickerTitle:I.i,pickerTitleIntervals:I.r},files:{pickerTitle:I.e,pickerTitleIntervals:I.t},folders:{pickerTitle:I.n,pickerTitleIntervals:I.a}};function O(e){var t,n=e.title,a=e.selectionMode,i=e.itemMode;if(n)t=n;else{var r="multiple"===a?2:1,o=C[i],s=o.pickerTitle,c=o.pickerTitleIntervals;t=Object(x.format)(Object(x.getLocalizedCountValue)(s,c,r)||"")}return t}var w=g.e.isActivated("182B2FCC-2348-48AB-BFBE-04969610C5E1","10/18/2021","Split picker options across query-string and post-messaging"),E=g.e.isActivated("69FB175A-8186-4311-9045-F073BA0B6A87","10/27/2021","Propagate current theme to File Picker"),A=i.forwardRef(function(e,t){var n,r,u,g,v,I=e.options,x=e.pickerPageUrl,C=e.app,A=e.scenario,L=e.onCommand,k=e.onNotification,M=e.className,P=e.theme,T=e.getAuthToken,U=e.reloadOnEntry,F=i.useState(null),H=F[0],R=F[1],N=i.useRef(),B=i.useRef(),j=B.current||(B.current=new f.e({name:"Sdk80FilePickerHost.".concat(A,".load")})),V=i.useRef(null),z=i.useCallback(function(e){V.current=e,R(e&&e.contentWindow||null)},[]),G=i.useState(function(){return"filePicker-".concat(d.generate())})[0],K=i.useMemo(function(){return Object(a.__assign)({sdk:"8.0",accessibility:{showFocusOnLoad:document.body.classList.contains(m.e),enableFocusTrap:!0}},!E&&P?{theme:P}:{})},[P]),W=i.useMemo(function(){return Object(_.n)(Object(_.n)(K,I||{}),{sdk:"8.0",messaging:Object(a.__assign)({origin:location.origin,channelId:G,identifyParent:!0},w?{}:{waitForConfiguration:!0})})},[I]),q=i.useMemo(function(){var e="string"==typeof W.theme?W.theme:function(e){return e?Object(a.__assign)(Object(a.__assign)({isInverted:e.isInverted},e.palette?{palette:Object(b.n)(e.palette,["white"])}:{}),e.semanticColors?{semanticColors:Object(b.n)(e.semanticColors,["bodyBackground"])}:{}):e}(W.theme),t=w?W:Object(a.__assign)(Object(a.__assign)({},Object(b.n)(W,["sdk","authentication","messaging","entry","accounts","teams","telemetry","views"])),!E&&e?{theme:e}:{});return"".concat(x,"?").concat(Object(l.e)({app:C,scenario:A,filePicker:JSON.stringify(t)}))},[x]),Q=Object(c.e)(e.onPick),Y=Object(c.e)(e.onClose),J=Object(c.e)(e.onLoad),X=Object(c.e)(function(e){if("page-loaded"===e.notification){var t=void 0,n=e.error;n&&(t=new S.e({code:n.code,message:n.message,isExpected:n.isExpected})),j.end(Object(D.e)(t)),J({error:t})}k&&k(e)}),Z=Object(c.e)(function(e){switch(e.command){case"pick":return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return j.end({resultType:f.t.Success}),[4,Q({items:e.items,keepSharing:e.keepSharing})];case 1:return t.sent(),[2,{result:"success"}]}})});case"close":return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(t=e.error)&&(n=new S.e({code:t.code,message:t.message,isExpected:t.isExpected})),j.end(Object(D.e)(n)),[4,Y({error:n||N.current||new y.e({message:"Closed"})})];case 1:return a.sent(),[2,{result:"success"}]}})})}if(L)return L(e)}),$=i.useRef(!1),ee=i.useRef();i.useEffect(function(){var e;if(H){var t=new s.e(x).authority;$.current=!0,null===(e=V.current)||void 0===e||e.setAttribute("aria-busy","true");var n=Object(o.e)({initTimeoutMs:6e4,channelId:G,origin:t,onNotification:X,onCommand:Z,identifyParent:!0,source:H});return ee.current=n,Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return T?[4,T({url:x})]:[3,2];case 1:return t=a.sent(),[3,3];case 2:t=void 0,a.label=3;case 3:return e=t,(i=H.document.createElement("form")).setAttribute("method","POST"),i.setAttribute("action",q),e&&((r=H.document.createElement("input")).setAttribute("type","hidden"),r.setAttribute("name","access_token"),r.setAttribute("value",e),i.appendChild(r)),H.document.body.appendChild(i),i.submit(),V.current&&V.current.focus(),w?[3,6]:[4,n.ready];case 4:return a.sent(),o={command:"configure",filePicker:W||{}},[4,n.sendCommand(o)];case 5:a.sent(),a.label=6;case 6:return $.current=!1,null===(s=V.current)||void 0===s||s.setAttribute("aria-busy","false"),N.current=void 0,[2]}})}).catch(function(e){var t;$.current=!1,null===(t=V.current)||void 0===t||t.setAttribute("aria-busy","false"),N.current||(N.current=e),J&&J({error:e})}),function(){ee.current=void 0,n.dispose()}}},[H]),i.useImperativeHandle(t,function(){return{sendCommand:function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){return(n=ee.current)?[2,n.sendCommand(e,t)]:[2,{result:"error",isExpected:!1}]})})}}});var te=Object(c.e)(function(e){N.current||(N.current=new S.e({code:"UnableToLoadPickerFrame"}),J&&J({error:N.current}))}),ne=i.useRef(null!==(n=W.entry)&&void 0!==n?n:{});i.useEffect(function(){Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return!ee.current||$.current?[3,3]:(e={command:"configure",filePicker:W||{}},t=null!==(i=W.entry)&&void 0!==i?i:{},n=Object(h.e)(ne.current,t),ne.current=t,[4,ee.current.sendCommand(e)]);case 1:return a.sent(),U&&n&&Object.keys(n).length>0?[4,ee.current.sendCommand({command:"load-page"})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})}).catch(function(){})},[W]);var ae=null!==(u=null===(r=null==W?void 0:W.selection)||void 0===r?void 0:r.mode)&&void 0!==u?u:"single",ie=null!==(v=null===(g=null==W?void 0:W.typesAndSources)||void 0===g?void 0:g.mode)&&void 0!==v?v:"files";return i.createElement("iframe",{"data-automationid":"filePickerFrame",ref:z,onError:te,title:O({title:W.title,selectionMode:ae,itemMode:ie}),className:Object(p.e)("frame_799d2892",M)})}),L=E?A:Object(v.e)(A,function(e){return{}}),k=n(427),M=n(1077),P=n(992),T=n(436),U=n(375),F=n(632);Object(u.n)([{rawString:".frame_01debc72{width:1080px;height:680px;max-width:100%;max-height:100%}.spinnerHost_01debc72{position:absolute;top:0;left:0;bottom:0;right:0;display:flex;justify-content:center;align-items:center;transition:opacity linear .3s 0s,visibility linear 0s 0s;background-color:"},{theme:"bodyBackground",defaultValue:"#fff"},{rawString:"}.spinnerHost_01debc72.loaded_01debc72{visibility:hidden;opacity:0;transition-delay:0s,0.3s}"}]);var H=n(634),R=n(1281),N=g.e.isActivated("B7BDF862-7031-4B0A-AC86-FB7D4FAB4BA6","2/24/2021","Make Picker modal once loaded"),B=g.e.isActivated("8907F6FD-B9E5-47A8-B133-A450AFEBD3E6","05/13/2022","Add a loading spinner to the File Picker host");function j(){return function(e){var t=e;return Object(F.e)()(function(e){var n,r=this,o=e.onClose,s=e.onLoad,d=e.className,l=e.responsiveMode,u=void 0===l?U.e.large:l,f=Object(a.__rest)(e,["onClose","onLoad","className","responsiveMode"]),m=Object(H.e)(),_=i.useRef(),h=i.useRef(),b=Object(c.e)(function(e){h.current=e.error,_.current=!0,m(),s&&s(e)}),g=Object(T.e)(u),v=Object(c.e)(function(){return Object(a.__awaiter)(r,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return o?[4,o({error:h.current||new y.e({message:"Dismissed"})})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}),S=i.useMemo(function(){return i.createElement(t,Object(a.__assign)({},f,{onLoad:b,onClose:o,className:Object(p.e)("frame_01debc72",g,d)}))},[f,b,o,g,d]);return i.createElement(P.e,{isOpen:!0,onDismiss:!_.current||h.current||N?v:void 0,styles:{main:{display:"flex",borderRadius:"6px"}}},S,B?null:i.createElement("div",{className:Object(p.e)("spinnerHost_01debc72",(n={},n.loaded_01debc72=!!_.current,n)),role:"presentation"},i.createElement(R.e,null)))})}}j()(L);var V=n(63),z=n(452),G=n(78),K=n(472),W=n(590),q=n(32),Q=n(123),Y=n(294),J=n(99),X=new Q.e("cloudStorageFolder",{providerCode:Object(Y.e)({BOX:"box",DROPBOX:"dropbox",EGNYTE:"engyte",GOOGLEDRIVE:"googledrive",SHAREFILE:"sharefile",SharePoint:"sharepoint"}),id:J.e}),Z=n(1060),$=n(51),ee=(new $.e("cloudStorageFolder"),new $.e("cloudStorageItem")),te=(new $.e("cloudStorageProviderType"),n(895)),ne=n(129),ae=new $.e("driveItemResponse"),ie=n(85),re=n(60),oe=n(442),se=n(252),ce=i.forwardRef(function(e,t){var n=e.itemKey,o=e.options,l=e.onPick,u=e.onCommand,f=e.onNotification,p=Object(a.__rest)(e,["itemKey","options","onPick","onCommand","onNotification"]),m=Object(se.r)(function(e){var t=e.demandItemFacet(k.e,r.r);return k.e.evaluate(function(){return{options:o}},t)(e,{itemKey:n,options:{},onCommand:u,onNotification:f})},[n,o]),_=m.result,h=m.isResolved,b=Object(se.t)(),g=Object(c.e)(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,o,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e.items,n=e.keepSharing,[4,b(Object(M.e)(function(e){return function(e,t){var n,a,i,o,c,l,u,f,p,m,_,h,b=t.sourceItems,g=[],v=Object(re.e)(e,{defaultGraphEndpoint:r.e}).defaultGraphEndpoint,y=new Z.e;if(b)for(var S=0,D=b;S<D.length;S++){var I=D[S],x=null===(a=I.sharepointIds)||void 0===a?void 0:a.listItemId,C=(null===(i=I.sharepointIds)||void 0===i?void 0:i.listId)||(null===(c=null===(o=I.parentReference)||void 0===o?void 0:o.sharepointIds)||void 0===c?void 0:c.listId),O=(null===(l=I.sharepointIds)||void 0===l?void 0:l.siteUrl)||(null===(f=null===(u=I.parentReference)||void 0===u?void 0:u.sharepointIds)||void 0===f?void 0:f.siteUrl),w=I["@sharePoint.listUrl"],E=I.id,A=null===(p=I.parentReference)||void 0===p?void 0:p.driveId,L=I.webDavUrl,k=I["@sharePoint.endpoint"]||v,M=e.demandItemFacet(ie.m,ne.e),P=I.name,T=I.folder,U=I["@teams"],F=void 0;if(w&&O&&I.root&&!M)F=G.e.serialize({webAbsoluteUrl:Object(K.e)(O),listFullUrl:Object(K.e)(w),rootFolder:""});else if(w&&O&&x&&!M)F=G.e.serialize({webAbsoluteUrl:Object(K.e)(O),listFullUrl:Object(K.e)(w),itemId:x});else if(x&&C&&O&&!M){var H=z.e.serialize({siteUrl:Object(K.e)(O),listId:d.normalizeLower(C,!1),uniqueId:""}),R=e.demandItemFacet(G.e,H,{suppressGetItems:!1});F=R&&G.e.serialize({webAbsoluteUrl:R.webAbsoluteUrl,listFullUrl:(m=R,_=new s.e(m.webAbsoluteUrl).authority,h=new s.e(m.listFullUrl).path,"".concat(_).concat(h)),itemId:x})}else if(E&&A&&O){var N=new s.e(Object(K.e)(O)).authority;F=V.e.serialize({endpoint:N,driveId:A,itemId:E})}else U?F=X.serialize({id:U.providerItem.id,providerCode:U.providerCode}):E&&A&&k?F=V.e.serialize({endpoint:k,driveId:A,itemId:E}):L&&I.sharepointIds&&(F=W.e.serialize({itemFullUrl:Object(K.e)(L)}));F&&(y.updateItems({items:(n={},n[F]=Object($.t)({folder:q.m,displayName:q.l,cloudStorageItem:ee,driveItemResponse:ae},{folder:new te.e(T?{}:void 0),displayName:new te.e(P),cloudStorageItem:new te.e(null==U?void 0:U.providerItem),driveItemResponse:new te.e(I)}),n)}),e.demandItemFacet(q.l,F),g.push(F))}return{sourceItemKeys:g,itemResolver:y}}(e,{sourceItems:t})}))];case 1:if(i=a.sent(),o=i.sourceItemKeys,c=i.itemResolver,o.length!==t.length)throw new S.e({code:"UnableToResolvePickedItem"});return b(c.execute()),[4,l({items:t,itemKeys:o,keepSharing:!!n})];case 2:return a.sent(),[2]}})})});if(Object(oe.e)(h,h,[_.pickerPageUrl])){var v=_.options,y=_.pickerPageUrl,D=_.onCommand,I=_.onNotification,x=_.getAuthToken;if(!y)throw new S.e({code:"NoPickerPageUrlForHost"});return i.createElement(L,Object(a.__assign)({ref:t,key:y},p,{pickerPageUrl:y,onCommand:D,onNotification:I,options:v,onPick:g,getAuthToken:x}))}return i.createElement("div",{className:p.className,"aria-hidden":!0,role:"presentation"})}),de=j()(ce)},1150:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(21),i=n(267),r=n(75),o=n(251),s=n(163),c=n(234),d=n(119),l=n(903),u=n(798),f=n(2).t.isActivated("29873e89-d94c-4bb0-8f5b-dfd437f6422c","6/19/2021","Look for filters within the folder structure for doclib by using GetListUsingPath API"),p=function(e){function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;return n._listContext=t.listContext,n._itemUrlHelper=t.itemUrlHelper||new s.e({},{pageContext:t.pageContext}),n._apiUrlHelper=t.apiUrlHelper||new c.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper}),n._folderPath=t.folderPath,void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext)),n}return Object(a.__extends)(t,e),t.prototype.getFilterData=function(e,t,n,a){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,a)},function(e){return e},"GetFilterData")},t.prototype._getFilterDataUrl=function(e,t,n,a){var i,s,c=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl});s=f?this._apiUrlHelper.build().webByItemUrl(c).method("GetList",c.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e):this._apiUrlHelper.build().webByItemUrl(c).methodWithAliases("GetListUsingPath",{DecodedUrl:c.serverRelativeListUrl}).segment("RenderListFilterData").parameter("FieldInternalName",e),n&&n!==u.e&&(s=s.parameter("ViewId",n)),this._folderPath&&(s=s.parameter("RootFolder",{raw:r.e.encodeURIComponent(this._folderPath)})),a&&a===o.e.Taxonomy&&(s=s.parameter("ExcludeFieldFilteringHtml",!0));var l=Object(d.i)(t,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:null===(i=this._pageContext)||void 0===i?void 0:i.userDisplayName});return(s=s.rawParameter(l)).toString()},t}(i.t)},1200:function(e,t,n){"use strict";n.d(t,"n",function(){return x}),n.d(t,"e",function(){return C}),n.d(t,"t",function(){return O});var a,i=n(51),r=n(525),o=n(526),s=n(21),c=n(508),d=n(58),l=n("react-lib"),u=n(33),f=n(337),p=n(76),m=n(68),_=n(67),h=n(1131),b=n(86),g=n(32),v=((a={})[p.a.started]=function(){return Object(_.formatToArray)(h.i)},a[p.a.completed]=function(){return Object(_.formatToArray)(h.t)},a[p.a.failed]=function(){return Object(_.formatToArray)(h.a)},a[p.a.canceled]=function(){return Object(_.formatToArray)(h.a)},a);function y(e){var t=this,n=e.url;return l.createElement(b.e,{onExecute:function(){return Object(s.__awaiter)(t,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return window.open(n),[2]})})}})}function S(e,t){var n,a=Object(m.a)(e,t).phase,i=v[a](),r=[];if(a===p.a.completed){"group"!==t.format&&(n=t.description);var o=e.demandItemFacet(p.v,t.itemKey),s=e.demandItemFacet(g.i,null==o?void 0:o.itemKey);if(s){var c={key:"view",name:h.r,action:y({url:s+"/AllItems.aspx?env=WebViewList"}),engagement:{name:"StreamPlaylist.AddToPlaylist.SWANotification.ViewPlaylist",isIntentional:!0}};r.push(c)}}else a===p.a.failed&&"group"!==t.format&&(n=t.description);return{title:i,description:n,commands:r}}function D(){return function(e){return S}}var I=Object(u.t)(function(){return function(e){e(Object(c.e)(C,f.e)(Object(d.t)()(D)))}}),x=new i.e("addItemToPlaylistOperation"),C=new r.e("addItemToPlaylistOperation"),O=Object(o.e)({operationTypeFacet:x,progressKeyFacet:C,initializeBatch:function(){return I}})},1239:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.SelectAll=3]="SelectAll"}(a||(a={}))},1245:function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(378),i=n(242),r=n(112),o=Object(i.e)("completeCommand"),s=Object(i.e)("cancelCommand"),c=new a.e("filePickerTray",{commands:a.t,promptAs:Object(r.e)()}),d=new a.e("filePickerTray",{initialModality:a.t,isModal:a.t});new a.e("filePicker",{trayControlHandler:Object(a.n)(c),leftPaneAs:Object(r.e)(),trayAs:Object(r.e)(),customizerAs:Object(r.e)(),searchBarAs:Object(r.e)(),headerAs:Object(r.e)(),topBarAs:Object(r.e)(),leftPaneControlHandler:Object(a.n)(d)})},1262:function(e,t,n){"use strict";n.r(t),n.d(t,"UploadDestinationPickerBase",function(){return m}),n.d(t,"UploadDestinationFilePicker",function(){return _});var a=n(21),i=n("react-lib"),r=n(148),o=n(990),s=n(125),c=n(331),d=n(763),l=n(1245),u=n(141),f=n(327),p={title:f.P,entry:{oneDrive:{files:{fallbackToRoot:!0}}},typesAndSources:{mode:"folders",pivots:{sharedLibraries:!0}},selection:{mode:"single"},commands:{upload:{enabled:!1},createFolder:{enabled:!1}},accessibility:{showFocusOnLoad:!0,enableFocusTrap:!0},tray:{commands:[{action:"pick",key:l.t,label:f.H},{action:"close",key:l.e,label:f.k}]}},m=Object(d.t)(function(e,t){var n=t.itemKey,a=t.wizardProps,r=t.uploadProps,o=t.entries,s=p;return t.defaultUploadLocation&&(s.entry.oneDrive.files.folder=t.defaultUploadLocation),i.createElement(_,{itemKey:n,wizardProps:a,uploadProps:r,filePickerOptions:s,entries:o,onDestinationSelected:t.onDestinationSelected})});function _(e){var t=this,n=e.uploadProps,d=e.filePickerOptions,l=e.entries,f=e.itemKey,p=n.uploaderAs,m=Object(a.__rest)(n,["uploaderAs"]),_=i.useState(!0),h=_[0],b=_[1],g=i.useState(""),v=g[0],y=g[1],S=Object(s.n)().consume(c.e),D=e.wizardProps.reject,I=Object(r.e)(function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(a){return b(!1),t=n.itemKeys[0],y(t),e.onDestinationSelected&&e.onDestinationSelected(),[2]})})}),x=Object(r.e)(function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return b(!1),D(e.error||new u.e),[2]})})}),C=Object(r.e)(function(){});return i.createElement(i.Fragment,null,h?i.createElement(o.e,{itemKey:f,app:S,options:d,onPick:I,onClose:x,onLoad:C,scenario:"PickUploadDestination"}):""!==v?i.createElement(p,Object(a.__assign)({},Object(a.__assign)(Object(a.__assign)({},m),{itemKey:v}),{entries:l})):null)}},1442:function(e,t,n){"use strict";n.r(t),n.d(t,"AddToPlaylistFilePickerBase",function(){return P}),n.d(t,"AddToPlaylistFilePicker",function(){return T});var a=n(21),i=n("react-lib"),r=n(148),o=n(48),s=n(472),c=n(125),d=n(331),l=n(327),u=n(32),f=n(63),p=n(28),m=n(78),_=n(246),h=n(402),b=n(763),g=n(658),v=n(972),y=n(1245),S=n(556),D=n(252),I=n(272),x=n(141),C=n(1200),O=n(226),w=n(990),E=n(1206),A=n(124),L=n(576),k=Object(g.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(62).then(n.bind(null,1398))];case 1:return[2,e.sent().ListCreationDialogContainer]}})})}),M={title:l.e,entry:{oneDrive:{myLists:{}}},typesAndSources:{filters:["playlist"],mode:"folders",pivots:{myLists:!0,recentLists:!0,recent:!1,oneDrive:!1,sharedLibraries:!1,shared:!1}},selection:{mode:"single"},commands:{upload:{enabled:!1},createFolder:{enabled:!1}},accessibility:{showFocusOnLoad:!0,enableFocusTrap:!0},tray:{commands:[{key:"newPlaylist",action:"custom",label:l.v},{action:"pick",key:y.t,label:l.y,primary:!0},{action:"close",key:y.e,label:l.g}]}},P=Object(b.t)(function(e,t){var n=t.itemKey,a=t.wizardProps,r=e.demandItem({driveItemKey:f.e,webDavUrl:u.i,listItemId:p.Ce,fileName:u.f,rowData:p.at,spItemKey:m.e,eTag:u.u,spListKey:_.e,uniqueId:p.Nt},n),o=Object(h.e)(e);return i.createElement(T,{itemKey:n,wizardProps:a,itemInfoFromCache:r,pageContextStream:o})});function T(e){var t=this,n=i.useState(!0),l=n[0],f=n[1],p=i.useState(!1),_=p[0],h=p[1],b=e.pageContextStream,g=e.itemKey,y=Object(c.n)().consume(d.e),P=e.wizardProps,T=P.resolve,U=P.reject,F=Object(D.t)(),H=Object(r.e)(function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,s;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),f(!1),t=n.itemKeys[0],F(Object(E.e)({items:(s={},s[t]=Object(a.__assign)({},A.e.pack(L.e.playlist)),s)})),i=n.itemKeys,[4,F(Object(C.t)({items:Object(O.e)(i,function(){return{itemKey:e.itemKey}})}))];case 1:return c.sent(),T(),[3,3];case 2:return r=c.sent(),U(new o.e({innerError:r})),[3,3];case 3:return[2]}})})}),R=Object(r.e)(function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return f(!1),U(e.error||new x.e),[2]})})}),N=Object(r.e)(function(e){if("custom"===e.command)return"newPlaylist"===e.key&&(I.e.logData({name:"StreamPlaylist.AddToPlaylist.NewPlaylist"}),f(!1),h(!0)),{result:"success"}}),B=Object(r.e)(function(){});return i.createElement(i.Fragment,null,_?i.createElement(k,{pageContext:b,mode:v.e.withListTemplate,workload:"StreamWebApp",isSettingsPage:!0,listTemplateId:S.e,onNavigate:function(n,i,r){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,c,d,l,f,p;return Object(a.__generator)(this,function(b){switch(b.label){case 0:if(!_)return[3,4];if(h(!1),t=n.substring(0,n.indexOf("?")),r=null==t?void 0:t.substring(n.lastIndexOf("/")+1,n.length-1),!t||!r)throw new o.e({code:"ListUrlOrTitleIsEmpty"});c=Object(s.e)(i),d=Object(s.e)(t),l=m.e.serialize({webAbsoluteUrl:c,listFullUrl:d,rootFolder:""}),b.label=1;case 1:return b.trys.push([1,3,,4]),F(Object(E.e)({items:(p={},p[l]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},A.e.pack(L.e.playlist)),u.i.pack(d)),u.l.pack(r)),p)})),[4,F(Object(C.t)({items:Object(O.e)([l],function(){return{itemKey:e.itemKey}})}))];case 2:return b.sent(),T(),[3,4];case 3:return f=b.sent(),U(new o.e({innerError:f})),[3,4];case 4:return[2]}})})},onDismiss:function(){h(!1),I.e.logData({name:"StreamPlaylist.AddToPlaylist.NewPlaylist.Close"})}}):null,l?i.createElement(w.e,{itemKey:g,app:y,options:M,onPick:H,onClose:R,onLoad:B,onCommand:N,scenario:"StreamPlaylist.AddToPlaylist"}):null)}},1471:function(e,t,n){"use strict";n.r(t),n.d(t,"addItemToPickedPlaylistOperationHandler",function(){return mt});var a,i,r=n(21),o=n(33),s=n(78),c=n(1077),d=n(63),l=n(32),u=n(28),f=n(246),p=n(70),m=n(84),_=n(38),h=n(461),b=n(132),g=n(247),v=n(244),y=n(1365),S=n(441),D=n(88),I=n(472),x=n(211),C=n(503),O=n(756),w=n(150),E=n(12),A=n(1059),L=n(75),k=n(686),M=n(752),P=n(943),T=n(267);!function(e){e[e.fail=0]="fail",e[e.partialSuccess=1]="partialSuccess",e[e.success=2]="success"}(a||(a={})),function(e){e[e.pending=0]="pending",e[e.success=1]="success"}(i||(i={}));var U,F=n(163),H=n(356),R=n(181),N=n(234),B=n(121),j=n(1150),V=n(448),z=n(286),G=n(192),K=n(147),W=n(662),q=n(651),Q=n(1124),Y=n(54),J=n(445),X=n(152),Z=n(543),$=n(7),ee=n(903),te=n(138),ne=n(44);!function(e){function t(e,t,n,a){if(e){var i=Object(ee.e)(function(e){return e.id||e.FileRef||e.ServerRelativeUrl}(e),n.listUrl),r={key:i};r.id=e.id||e.FileRef,r.itemId=e["name.FileSystemItemId"];var o=e.File_x0020_Type;r.extension=o?"."+o:void 0,r.policyTip=e._ip_UnifiedCompliancePolicyUIAction?Number(e._ip_UnifiedCompliancePolicyUIAction):G.a.none,r.type=function(e,t,n){var a=w.e.File,i=e.File_x0020_Type;if("1"===e.FSObjType){var r=e["File_x0020_Type.mapapp"],o=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];a=r&&"onenote"===r.substring(0,7)||o&&-1!==o.indexOf("onenote")?w.e.OneNote:w.e.Folder}else J.e.isShortcutEnabled()&&J.e.isShortcutFileType(i)?a=w.e.Shortcut:"pdf"===i?a=w.e.Media:(a=X.a(i))===w.e.Unknown&&Object(ne.r)(n.listTemplateType)&&(a=w.e.File);return".ai"!==t.extension&&".eps"!==t.extension&&".psd"!==t.extension||(a=w.e.Media),a===w.e.Folder?t.isDocSet="Sharepoint.DocumentSet"===e.ProgId:a===w.e.File&&n&&!n.isDocLib&&(t.listItem={}),a}(e,r,n),r.extension&&(r.iconName=X.n(r)),r.isRootFolder=e.isRootFolder;var s=Object(V.getItemName)(e,r.type,n);s&&(r.displayName=r.name=s),r.dateModifiedValue=e.Modified,r.dateModified=e["Modified.FriendlyDisplay"]?Object(Q.e)(e["Modified.FriendlyDisplay"]):String(e.Modified),r.permissions=e.PermMask?q.e(e.PermMask):void 0,r.isPlaceholder=!e.PermMask,r.hasMissingMetadata=function(e,t){if(!t.listSchema)return!1;var n=t.listSchema.filter(function(e){return e.isRequired&&Boolean(e.name)}),a=!1;if(n&&n.length>0)for(var i in n)if(i&&!e[n[i].internalName]){a=!0;break}return a}(e,n);var c=e["serverurl.progid"];if(r.openUrl=c?c.substring(1):e.FileRef,-1!==r.openUrl.toLowerCase().indexOf("/wopiframe?")&&(r.openUrl=r.openUrl.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?")),r.previewIFrameUrl=e.ServerRedirectedEmbedUrl,r.appMap=e["File_x0020_Type.mapapp"]||e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],r.size=e.File_x0020_Size?Number(e.File_x0020_Size):void 0,r.totalSize=e.SMTotalSize?Number(e.SMTotalSize):void 0,a.blockDownloadsExperienceEnabled&&(r.type===w.e.Media||r.openUrl&&r.appMap)?r.itemStatus=K.t.ConditionalAccessViewOnly:a.blockDownloadsExperienceEnabled?r.itemStatus=K.t.ConditionalAccessBlocked:a.viewOnlyExperienceEnabled&&(r.itemStatus=K.t.ConditionalAccessViewOnly),r.type===w.e.Folder){r.folder={},r.childCount=Number(e.ItemChildCount)+Number(e.FolderChildCount);var d=Number(e.SMTotalFileCount);r.folder.totalCount=d>0?d:r.childCount,r.folder.childCount=r.childCount}for(var l in r.isDraggable=!0,r.isDropEnabled=r.type===w.e.Folder,r.properties={},e)e.hasOwnProperty(l)&&(r.properties[l]=e[l]);var u=e.UniqueId&&Y.e.normalizeLower(e.UniqueId);u&&(r.properties.uniqueId=u);var f=r.name;return r.extension&&(f=r.name.substring(0,r.name.toLowerCase().lastIndexOf(r.extension.toLowerCase()))),r.properties.FileName=f,Number(e.PrincipalCount)>0?r.sharingType=Z.e.Shared:void 0===e.PrincipalCount?r.sharingType=Z.e.Unknown:r.sharingType=Z.e.Private,Object(W.n)(e,t,n),r}}e.buildItems=function(e,n,a,i,r){for(var o=[],s=[],c=e.Row,d=c.length,l=0;l<d;l++){var u=t(c[l],s,n,a);u.parent=i,u.parentKey=i.key,r&&r.setItem(u.key,u),o.push(u)}var f=0;if(s.length>0){var p=s[s.length-1];f=p.startIndex+p.count}else s=void 0,f=d>0?e.LastRow:0;return{items:o,groups:s,totalCount:f}},e.buildRootItem=function(e,t,n,a){var i=function(e){var t=e;return 0===e.indexOf("id")&&(t=Object($.e)(e).id),t}(e),r=Object(ee.e)(i,n.listUrl),o={key:r},s=t.ListTitle,c=t.AllowCreateFolder,d=t.EnableMinorVersions,l=t.verEnabled,u=t.AllowGridMode,f=t.DisableGridEditing,p=t.ListTemplateType,m=t.BasePermissions,_=void 0===m?{}:m,h=_.ManageLists,b=void 0===h?void 0:h,g=_.ManagePersonalViews,v=void 0===g?void 0:g,y=_.OpenItems,S=void 0===y?void 0:y,D=t.ListSchema,I=(void 0===D?{}:D).DefaultItemOpen,x=void 0===I?void 0:I,C=t.ExcludeFromOfflineClient,O=t.WebExcludeFromOfflineClient,E=t.ListData,A="string"==typeof x?"0"===x:void 0;if(a){var L=a.getItem(r);L&&(o=L)}return o.type=w.e.Folder,o.isRootFolder=i===n.listUrl,Object(te.default)(o,{permissions:te.optional(E?q.e(E.FolderPermissions):void 0)}),void 0===o.list&&(o.list={}),Object(te.default)(o.list,{id:te.optional(t.listName),title:te.optional(s),allowGridMode:"boolean"==typeof u?u:te.backup(!0),allowCreateFolder:te.optional(c),disableCommenting:"boolean"==typeof t.DisableCommenting&&t.DisableCommenting,disableGridEditing:"boolean"==typeof f?f:te.backup(!1),enableMinorVersions:te.optional(d),enableVersions:te.optional(l),templateType:te.optional("string"==typeof p?Number(p):void 0),isDocumentLibrary:te.optional("string"==typeof p?Object(ne.i)(p):void 0),isPromotedLinks:te.optional("string"==typeof p?Object(ne.o)(p):void 0),isForceCheckout:te.optional(t.isForceCheckout),isModerated:te.optional(t.isModerated),enableRequestSignOff:te.optional(t.EnableRequestSignOff),newWOPIDocumentEnabled:te.optional(t.NewWOPIDocumentEnabled),newWOPIDocumentTypes:te.optional(t.NewWOPIDocumentTypes),permissions:{manageLists:te.optional(b),managePersonalViews:te.optional(v),openItems:te.optional(S)},openInClient:te.optional(A),excludeFromOfflineClient:te.optional("boolean"==typeof C||"boolean"==typeof O?C||O:void 0),contentTypesEnabled:te.optional(t.ContentTypesEnabled),metadataNavFeatureEnabled:te.optional(t.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:te.optional(t.canUserCreateMicrosoftForm),itemCount:te.optional(t.ListSchema&&t.ListSchema.ItemCount),rowLimit:te.optional(E&&E.RowLimit)}),o.isRootFolder&&(o.name=o.displayName=s),a&&a.setItem(r,o),o},e.buildItem=t}(U||(U={}));var ae,ie,re=function(){function e(e){this._listContext=e.listContext,this._pageContext=e.pageContext,this._itemStore=e.itemStore}return e.prototype.processData=function(e,t){Object(V.updateListContext)(t,this._listContext),Object(V.updateListContextGroupInfo)(this._listContext);var n=t.ListSchema&&"TRUE"===t.ListSchema.Collapse,a=this._processSchema(t.ListSchema),i=t.ListContenTypes,r=t.ListData||t,o=U.buildRootItem(e,t,this._listContext,this._itemStore),s=this._processItems(r,n,o);return{root:o,items:s.items,groups:s.groups,totalCount:s.totalCount,startIndex:this._getStartIndex(r),columns:a,contentTypes:i,nextRequestToken:this._getNextRequestToken(r),isAllGroupsCollapsed:n}},e.prototype._processSchema=function(e){if(e){var t={},n={hasFixedSchema:this._listContext.listTemplateType===ne.n.mySiteDocumentLibrary};this._listContext.listSchema=Object(z.buildSchema)(e,this._listContext,n,t),Object.keys(t).length&&(this._listContext.groupSchema=t)}return this._listContext.listSchema},e.prototype._processItems=function(e,t,n){var a;return(a=t?Object(W.e)(e.Row,this._listContext):U.buildItems(e,this._listContext,this._pageContext,n,this._itemStore)).groups&&a.groups.length>0&&(this._listContext.lastGroup=a.groups[a.groups.length-1]),{items:a.items?a.items:[],groups:a.groups,totalCount:a.totalCount}},e.prototype._getStartIndex=function(e){var t=0;return this._listContext.group?t=this._listContext.group.startIndex:e.FirstRow&&(t=e.FirstRow-1),t},e.prototype._getNextRequestToken=function(e){var t="";return e.NextHref&&(t=(t=e.NextHref).replace("&View=00000000-0000-0000-0000-000000000000","")),t},e}(),oe=n(67);!function(e){e[e.remove=0]="remove",e[e.add=1]="add"}(ae||(ae={})),function(e){e[e.attachment=0]="attachment",e[e.image=1]="image"}(ie||(ie={}));var se=n(2),ce=function(e){function t(t,n){var a=e.call(this,{},n)||this,i=t.apiUrlHelper,r=t.itemUrlHelper;return a._itemUrlHelper=r,a._apiUrlHelper=i,a}return Object(r.__extends)(t,e),t.prototype.getAttachments=function(e,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e,t).toString()},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.resultes&&0===t.d.results.length)return[];var a=t.d.results;return n.transformAttachmentData(a)},"Attachments")},t.prototype.addAttachment=function(e,t,n){var a=this;return new O.t(function(i,r){var o=new FileReader;o.onload=function(s){var c=o.result;a.doUploadAttachment(e,t,n.name,c).then(i,r)},o.readAsArrayBuffer(n)},function(){})},t.prototype.deleteAttachment=function(e,t,n,a){var i=this;return new O.t(function(r,o){i.doDeleteAttachment(e,t,n,a||!1).then(r,o)},function(){})},t.prototype.getDataSourceName=function(){return"AttachmentDataSource"},t.prototype.addImage=function(e,t,n,a,i,r,o){var s=this;return new O.t(function(c,d){var l=new FileReader;l.onload=function(u){var f=l.result;s.doUploadImage(t,a,i,o.name,f,n,e,r).then(c,d)},l.readAsArrayBuffer(o)},function(){})},t.prototype.attachImage=function(e,t,n){var a=this;return new O.t(function(i,r){var o=new FileReader;o.onload=function(s){var c=o.result;a.doUpdateImage(e,t,n.name,c).then(i,r)},o.readAsArrayBuffer(n)},function(){})},t.prototype.deleteImage=function(e,t,n){var a=this;return new O.t(function(i,r){a.doUpdateImage(e,t,n).then(i,r)},function(){})},t.prototype.doUpdateImage=function(e,t,n,a){var i=this._itemUrlHelper.getUrlParts(),r=this._apiUrlHelper.build().webByItemUrl(i).method("GetList",i.serverRelativeListUrl).method("Items",e).methodWithAliases("AddThumbnailFieldData",{imageName:n,fieldInternalName:t});return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t=JSON.parse(e);return t.d&&void 0!==t.d.AddThumbnailFieldData},qosName:"AddThumbnailFieldData",noRedirect:!0,additionalPostData:a||void 0})},t.prototype.buildAttachmentBaseUrl=function(e,t,n){var a=this._itemUrlHelper.getItemUrlParts(t),i=this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).method("Items",e);return n?i.method("AttachmentFiles",n):i.segment("AttachmentFiles")},t.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{type:"attachment",fileName:e.FileName,serverRelativeUrl:Object(B.a)(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})},t.prototype.doUploadAttachment=function(e,t,n,a){var i=this;return this.dataRequestor.getData({url:this.buildAttachmentBaseUrl(e,t).methodWithAliases("addUsingPath",{decodedUrl:n}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d)return null;var n=[t.d],a=i.transformAttachmentData(n);return a&&1===a.length?a[0]:null},qosName:"UploadAttachment",additionalPostData:a,noRedirect:!0})},t.prototype.doDeleteAttachment=function(e,t,n,a){var i=this;return this.getData(function(){return i.buildAttachmentBaseUrl(e,t,n).segment(a?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return a&&void 0!==t.d.DeleteObject||!a&&void 0!==t.d.RecycleObject}catch(e){return!1}},a?"DeleteAttachment":"RecycleAttachment")},t.prototype.doUploadImage=function(e,t,n,a,i,r,o,s){var c=this,d=this._itemUrlHelper.getItemUrlParts(e),l=this._apiUrlHelper.build().webByItemUrl(d).methodWithAliases("UploadImage",{listTitle:t,imageName:a,listId:r,itemId:o,fieldId:s});return se.t.isActivated("dd617e52-55d0-40bc-9e0f-ffd875d6a25c","11/10/2021","pipe through filed id to UploadImage call")&&(l=this._apiUrlHelper.build().webByItemUrl(d).methodWithAliases("UploadImage",{listTitle:t,imageName:a,listId:r,itemId:o})),this.dataRequestor.getData({url:l.toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d.UploadImage)return null;var a=t.d.UploadImage;return c.transformImageData(a,n,s)||null},qosName:"UploadImage",additionalPostData:i,noRedirect:!0})},t.prototype.transformImageData=function(e,t,n){return{type:"thumbnail",fileName:e.Name,serverRelativeUrl:e.ServerRelativeUrl,id:e.UniqueId,fieldName:t,serverUrl:Object(B.a)(this._pageContext),fieldId:n}},t}(T.e),de=n(1363),le=n(272),ue={ODB:1770},fe=function(){function e(e){this.listTitle=e.pageContext.listTitle,this.listId=Y.e.normalizeLower(e.pageContext.listId,!1);var t=new F.e({},{pageContext:e.pageContext}),n=new N.e({},{itemUrlHelper:t,pageContext:e.pageContext}),a={pageContext:e.pageContext};this.dataSource=new ce({apiUrlHelper:n,itemUrlHelper:t},a),this.isImageColumnUsingAttachmentsInListEnabled=E.n.isFeatureEnabled(ue),this.imageOperationsPool=[],this.attachmentOperationsPool=[]}return e.prototype.createAddAttachmentOperation=function(e,t,n){var a={type:ae.add,listItemId:e,listItemKey:t,fileType:ie.attachment,fileName:n.name,file:n};this.handleNewOperation(a,this.attachmentOperationsPool)},e.prototype.createDeleteAttachmentOperation=function(e,t,n){var a={type:ae.remove,listItemId:e,listItemKey:t,fileType:ie.attachment,fileName:n};this.handleNewOperation(a,this.attachmentOperationsPool)},e.prototype.createAddImageOperation=function(e,t,n,a,i){var r={type:ae.add,listItemId:e,listItemKey:t,fileType:ie.image,fileName:n.name,file:n,fieldName:a,fieldId:i};this.handleNewOperation(r,this.imageOperationsPool)},e.prototype.createDeleteImageOperation=function(e,t,n,a){var i={type:ae.remove,listItemId:e,listItemKey:t,fileType:ie.image,fileName:n,fieldName:a};this.handleNewOperation(i,this.imageOperationsPool)},e.prototype.executeImageOperationsOnSingleItem=function(e,t,n){var a=this.imageOperationsPool.slice();return this.clearImageOperations(e||0,t,n),this.executeAllOperationsCore(a,e,t)},e.prototype.executeImageOperationsOnMultipleItems=function(e){var t=this;if(0===e.length)return O.t.resolve([]);var n=[];return e.forEach(function(e){n.push(t.executeImageOperationsOnSingleItem(e,void 0,!1))}),O.t.all(n).then(function(e){var t=[];return e.forEach(function(e){e.forEach(function(e){t.push(e)})}),t})},e.prototype.executeAttachmentOperations=function(e){return this.executeAllOperationsCore(this.attachmentOperationsPool,e,void 0)},e.prototype.hasPendingImageOperations=function(){return this.imageOperationsPool.length>0},e.prototype.hasPendingAttachmentOperations=function(){return this.attachmentOperationsPool.length>0},e.prototype.clearAttachmentOperations=function(){this.attachmentOperationsPool=[]},e.prototype.executeAllOperationsCore=function(e,t,n){var a=this,i=e;return n&&(i=e.filter(function(e){return e.fieldName===n})),new O.t(function(e,r){if(i.length>0){var o=i[0],s=i.slice(1),c=void 0;o.type===ae.add?(void 0===t||o.listItemId||(o.listItemId=t),c=a.processUpload(o.listItemId,o.listItemKey,o.file,o.fileType,o.fieldName,o.fieldId)):c=a.processDelete(o.listItemId,o.listItemKey,o.fileName,o.fileType,o.fieldName);var d=function(i){a.executeAllOperationsCore(s,t,n).done(function(t){return e([i].concat(t))},r)};c.done(d,d),le.e.logData({name:"ClientFormUpdate.attachments"})}else e([])})},e.prototype.processUpload=function(e,t,n,a,i,r){return a===ie.image?this.isImageColumnUsingAttachmentsInListEnabled?this.dataSource.attachImage(e,i,n).then(function(e){return{result:e,attachment:null,image:{type:"thumbnail",fieldName:i,fileName:n.name},errorMsg:e?null:oe.format(de.n,n.name)+"."}},function(e){var t=oe.format(de.n,n.name);throw e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=de.a:e.message&&e.message.value&&(t+=" : "+e.message.value)),{result:!1,attachment:null,image:{type:"thumbnail",fieldName:i,fileName:n.name},errorMsg:t}}):this.dataSource.addImage(e,t,this.listId,this.listTitle,i,r,n).then(function(e){return{result:!0,attachment:null,image:e,errorMsg:e?null:oe.format(de.n,n.name)+"."}},function(e){var t=oe.format(de.n,n.name);throw e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=de.a:e.message&&e.message.value&&(t+=" : "+e.message.value)),{result:!1,attachment:null,image:{type:"thumbnail",fieldName:i,fileName:n.name,serverUrl:null,fieldId:r},errorMsg:t}}):this.dataSource.addAttachment(e,t,n).then(function(e){return{result:!0,attachment:e,errorMsg:e?null:oe.format(de.t,n.name)+"."}},function(e){throw{result:!1,attachment:{type:"attachment",uploaded:!1,fileName:n.name},errorMsg:oe.format(de.t,n.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})},e.prototype.processDelete=function(e,t,n,a,i,r){var o;if(a===ie.image){if(!this.isImageColumnUsingAttachmentsInListEnabled)return O.t.wrap({result:!0,image:{type:"thumbnail",fieldName:i,fileName:n,serverRelativeUrl:null,serverUrl:null,fieldId:r},errorMsg:null});o=this.dataSource.deleteImage(e,i,n).then(function(e){return{result:e,errorMsg:e?null:oe.format(de.n,n)+"."}},function(e){throw{result:!1,errorMsg:oe.format(de.n,n)}})}else o=this.dataSource.deleteAttachment(e,t,n).then(function(e){return{result:e,errorMsg:e?null:oe.format(de.e,n)+"."}},function(e){throw{result:!1,errorMsg:oe.format(de.e,n)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}});return o},e.prototype.handleNewOperation=function(e,t){var n=e.type,a=this.findDuplicateOperation(e,t);n===ae.add?a<0&&t.push(e):a<0?t.push(e):t.splice(a,1)},e.prototype.findDuplicateOperation=function(e,t){var n=e.fileType,a=-1;return t.some(function(t,i){var r=!1;if((isNaN(t.listItemId)&&isNaN(e.listItemId)||t.listItemId===e.listItemId)&&(r=!0),t.type===ae.add&&r&&t.fileName===e.fileName&&(n!==ie.image||t.fieldName===e.fieldName))return a=i,!0}),a},e.prototype.clearImageOperations=function(e,t,n){if(this.imageOperationsPool.length>0)if(n||!e)this.imageOperationsPool=[];else{var a=this.imageOperationsPool.filter(function(n){return Number(n.listItemId)!==e||!!t&&n.fieldName!==t});this.imageOperationsPool=a}},e}(),pe=n(1264);function me(e){return!!(256&e)}function _e(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?pe.RetainForeverText:" ";var t=be(e.TagDuration);return e.BlockDelete?oe.format(pe.PreserveTagText,t):e.AutoDelete?oe.format(pe.DeleteTagText,t):" "}function he(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return pe.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?pe.PreserveForeverTooltip:pe.NoRetentionTooltip;var t=be(e.TagDuration),n="",a="";e.BlockDelete?(n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip",e.BlockEdit&&(a=pe.PreserveIsRecordTooltipModifier),e.ReviewerEmail?a+=pe.ReviewTooltip:a+=e.AutoDelete?pe.PreserveAutoDeleteTooltipModifier:pe.PreserveNoDeleteTooltipModifier):e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var i=pe[n];return i?oe.format(i,t)+a:null}function be(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var a=n>1?pe.RetentionPeriodYears:pe.RetentionPeriodYear;t=oe.format(a,n)}else{var i=Math.floor(e/30);if(i>0){var r=i>1?pe.RetentionPeriodMonths:pe.RetentionPeriodMonth;t=oe.format(r,i)}else{var o=e>1?pe.RetentionPeriodDays:pe.RetentionPeriodDay;t=oe.format(o,e)}}}return t}function ge(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function ve(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()==="D4B6480A-4BED-4094-9A52-30181EA38F1D".toLowerCase()));var t,n}var ye=function(e){function t(t,n){var a=e.call(this,{},n)||this,i=t.apiUrlHelper,r=t.itemUrlHelper;return a._apiUrlHelper=i,a._itemUrlHelper=r,a}return Object(r.__extends)(t,e),t.prototype.isAdvancedRecordVersioningDisabled=function(){return this.dataRequestor.getData({url:this._buildRecordVersioningUrl(),qosName:"GetAdvancedRecordVersioningDisabled",method:"GET"}).then(function(e){return!!(e&&e.d&&e.d.GetAdvancedRecordVersioningDisabled)&&e.d.GetAdvancedRecordVersioningDisabled},function(e){return O.t.wrapError(e)})},t.prototype.getAvailableTagsForSite=function(){var e=this;return this.dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return O.t.wrapError(pe.GetAvailableTagsForSiteFailed)})},t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length)return M.e.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n}),O.t.wrap([]);var a=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this.dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:a,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return O.t.wrapError(e)})},t.prototype.updateComplianceTag=function(e,t){var n="SetComplianceTag",a=t.blockEdit||t.blockDelete,i=t.blockEdit,r=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:a,isTagPolicyRecord:i,isEventBasedTag:r,isTagSuperLock:t.superLock,isUnlockedAsDefault:t.unlockedAsDefault});return this.dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,n),qosName:n,additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return O.t.wrapError(e)})},t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){return!!(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results)&&me(e.d.UnlockRecordItem.results)},function(e){return O.t.wrapError(e)})},t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){return!!(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results)&&me(e.d.LockRecordItem.results)},function(e){return O.t.wrapError(e)})},t.prototype._buildRecordVersioningUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAdvancedRecordVersioningDisabled",{}).toString()},t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()},t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()},t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:pe.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:pe.NoneComplianceTagDescription,tagTooltip:pe.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:"",unlockedAsDefault:!1};t.push(n);for(var a=0,i=e;a<i.length;a++){var r=i[a],o=_e(r),s=he(r),c={tagName:r.TagName,tagValue:r.TagName,blockDelete:r.BlockDelete,blockEdit:!!r.BlockEdit,tagDescription:o,tagTooltip:s,hasRetentionAction:r.HasRetentionAction,autoDelete:r.AutoDelete,isEventTag:r.IsEventTag,reviewerEmail:r.ReviewerEmail,notes:r.Notes,displayName:r.DisplayName,superLock:r.SuperLock,tagId:r.TagId,unlockedAsDefault:r.UnlockedAsDefault};t.push(c)}return t},t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()},t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()},t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()},t}(T.e),Se=function(){function e(e){var t=new F.e({},{pageContext:e.pageContext}),n=new N.e({},{itemUrlHelper:t,pageContext:e.pageContext}),a={pageContext:e.pageContext};this._dataSource=new ye({apiUrlHelper:n,itemUrlHelper:t},a)}return e.prototype.isAdvancedRecordVersioningDisabled=function(){return this._dataSource.isAdvancedRecordVersioningDisabled()},e.prototype.getAvailableTagsForSite=function(){return this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite()),this._cachedTagsPromise},e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)},e.prototype.updateComplianceTagInBatch=function(e,t,n){return this._dataSource.updateComplianceTagInBatch(e,t,n)},e.prototype.unlockRecord=function(e,t){return this._dataSource.unlockRecord(e,t)},e.prototype.lockRecord=function(e,t){return this._dataSource.lockRecord(e,t)},e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&e.length>1)})},e}(),De=n(49),Ie=n(46),xe="OnChangingTags";function Ce(e,t){void 0===t&&(t=1);try{for(var n=e.fields.length,a=0;a<n;a++)if("TaxonomyFieldType"===e.fields[a].schema.FieldType||"TaxonomyFieldTypeMulti"===e.fields[a].schema.FieldType){var i=Oe(e.fields[a].serverData,e.fields[a].data);if(0===i.addedTagsCount&&0===i.deletedTagsCount)continue;var r=e.fields[a].schema.FieldType.toLowerCase();e.isBulkEdit||t>1?r+=".BulkEdit.":r+=".NotBulkEdit.",r+=xe;for(var o=0;o<t;o++)le.e.logData({name:r,isIntentional:!0,extraData:{deletedTagsCount:i.deletedTagsCount,addedTagsCount:i.addedTagsCount}})}}catch(e){return void Ie.e.logError(e,{eventName:xe})}}function Oe(e,t){var n=we(e),a=we(t),i=0,r=Object.keys(n).length,o=Object.keys(a).length;if(r>0&&o>0)for(var s in n)a[s]&&i++;return{deletedTagsCount:r-i,addedTagsCount:o-i}}function we(e){if(!e)return{};for(var t={},n=0,a=e.split(";");n<a.length;n++)t[a[n]]=!0;return delete t[""],t}function Ee(){return void 0!==window._TeamsListApp?"TeamsList":void 0!==window._TeamsPageApp?"TeamsPage":"SP"}var Ae=n(117),Le=function(){function e(){}return e.newItemCreated="clientFormNewItemCreated",e.itemUpdated="clientFormItemUpdated",e}();function ke(e){if(e){if("string"!=typeof e)return e;var t=void 0;try{t=JSON.parse(e)}catch(e){}if(t&&0!==Object.getOwnPropertyNames(t).length)return t}}var Me=n(587),Pe=n(821),Te=n(579),Ue=n(787),Fe=se.e.isActivated("8a599b0b-8859-422a-aa10-ca6a49ce77eb","04/04/2022","Switch to newer sensitivity label api path"),He=function(){function e(e,t){var n=t.pageContext,a=t.graphDataRequestor;this._pageContext=n,this._graphDataRequestor=a||new Me.e({},{}),this._getOAuthToken=e.getOAuthToken,this._getOAuthToken2=t.getOAuthToken,this._cache=new Pe.e({id:"SensitivityLabelsDataSource"},{pageContext:n})}return e.prototype.getSensitivityLabels=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(r.__generator)(this,function(t){return[2,this._cache.getDataUtilizingCache({cachingStrategy:Te.e.useCacheIfNotExpired,cacheTimeoutTime:Ue.i,cacheRequestKey:"SensitivityLabelsDataSource",getData:function(){return e._getSensitivityLabels()}}).catch(function(){return null})]})})},e.prototype.getDocLibSensitivityLabelsCached=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(r.__generator)(this,function(t){return[2,this._cache.getDataUtilizingCache({cachingStrategy:Te.e.useCacheAndUpdateInTheBackground,cacheRequestKey:"SensitivityLabelsDataSourceDocLib",getData:function(){return e.getDocLibSensitivityLabels()}}).catch(function(){return null})]})})},e.prototype.getDocLibSensitivityLabels=function(){return Object(r.__awaiter)(this,void 0,O.t,function(){var e,t,n,a,i=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return this._getOAuthToken||this._getOAuthToken2?(e="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2]):[2,O.t.resolve([])];case 1:return n=r.sent(),[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=r.sent(),r.label=4;case 4:return t=n,this._sensitivityLabels?(a=this._sensitivityLabels,[3,7]):[3,5];case 5:return[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,"/beta/me/informationprotection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){var t=JSON.parse(e.responseText).value;return i._sensitivityLabels=t,t}})];case 6:a=r.sent(),r.label=7;case 7:return[2,a]}})})},e.prototype.setSensitivityLabel=function(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,o,s,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i={id:n,assignmentMethod:"Privileged",justificationText:a||"",actionSource:"Manual"},this._getOAuthToken||this._getOAuthToken2?(o="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],o)]:[3,2]):[2,Promise.resolve("")];case 1:return c=r.sent(),[3,4];case 2:return[4,this._getOAuthToken2(o)];case 3:c=r.sent(),r.label=4;case 4:return s=c,[4,this._graphDataRequestor.send({endpoint:o,path:"".concat(o,"/beta/drives/").concat(e,"/items/").concat(t,"/setSensitivityLabel"),apiName:"GraphDataProvider.setSensitivityLabel",postData:JSON.stringify(i),accessToken:{accessToken:s},requestType:"POST",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,r.sent()]}})})},e.prototype._getSensitivityLabels=function(){return Object(r.__awaiter)(this,void 0,O.t,function(){var e,t,n;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return this._getOAuthToken||this._getOAuthToken2?(e="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2]):[2,O.t.resolve([])];case 1:return n=a.sent(),[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=a.sent(),a.label=4;case 4:return(t=n)?[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,Fe?"/beta/me/informationprotection/policy/labels":"/beta/me/security/informationProtection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,parseResponse:function(e){return JSON.parse(e.responseText).value.filter(function(e){return!0===e.isActive}).sort(function(e,t){return e.sensitivity>t.sensitivity?1:-1})}})]:[2,O.t.resolve([])];case 5:return[2,a.sent()]}})})},e}(),Re=n(1239),Ne=n(1364),Be={id:"none",key:"none",text:Ne.e,title:Ne.e},je=function(){function e(){}return e.processSensitivityLabelsForDropdownOption=function(e){var t={};e.forEach(function(e){var n,a,i=e.name,r=null===(n=null==e?void 0:e.parent)||void 0===n?void 0:n.name;r?t[r]?null===(a=t[r])||void 0===a||a.push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip}):(t[r]=[{name:r,id:"".concat(e.id,"isParent"),isParent:!0,tooltip:e.tooltip}],t[r].push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip})):t[i]=[{name:i,id:e.id,isParent:!1,tooltip:e.tooltip}]});var n=[];return t&&Object.keys(t).length>0&&Object.keys(t).forEach(function(e){var a=t[e];if((null==a?void 0:a.length)>1){var i=a[0];a.forEach(function(e){var t=e.isParent?Re.e.Header:Re.e.Normal,a=e.isParent?e.name:"".concat(i.name," \\ ").concat(e.name);n.push({id:e.id,key:e.id,text:a,title:e.tooltip,data:{text:e.name,isParent:e.isParent},itemType:t})}),n.push({key:"divider_2",text:"-",itemType:Re.e.Divider})}else n.push({id:a[0].id,key:a[0].id,text:a[0].name,title:a[0].tooltip,data:{text:a[0].name}})}),n},e.processSensLabelsForDropdownOptionDocLib=function(e){var t=[];return t.push(Be),e.forEach(function(e){var n,a=e.displayName;if(0===e.sublabels.length){if(ze(e.labelActions)){var i=Ve(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),a,e.toolTip);t.push(i)}}else e.sublabels.forEach(function(e){var n;if(ze(e.labelActions)){var i="".concat(a," \\ ").concat(e.displayName),r=Ve(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),i,e.toolTip);t.push(r)}})}),t},e.processLabelsForItem=function(e){var t=[];return t.push(Be),e.forEach(function(e){var n,a=e.displayName;if(0===e.sublabels.length){var i=ze(e.labelActions),r=e.tooltip||e.toolTip;if(i){var o=Ve(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),a,r);t.push(o)}}else e.sublabels.forEach(function(e){var n,i=ze(e.labelActions),r=e.tooltip||e.toolTip;if(i){var o="".concat(a," \\ ").concat(e.displayName),s=Ve(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),o,r);t.push(s)}})}),t},e}();function Ve(e,t,n,a){return{id:e,key:t,text:n,title:a}}function ze(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if("userDefinedRights"===e[t].encryptWith)return!1;return!0}var Ge=n(3),Ke="0x0120",We={ODB:788,OneDrive:!0},qe={ODB:573,OneDrive:!0},Qe={ODB:1261},Ye={ODB:1293},Je={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},Xe={ODB:60092,ODC:void 0,Fallback:!1},Ze={ODB:1770},$e="CreateItem",et="UpdateItem",tt=se.t.isActivated("DC2F1582-A7C4-4DDA-AB48-39490F5EBB18","04/18/2022","fix event fields on update"),nt={ODB:60925},at=se.t.isActivated("8aa8a122-dec2-44e9-b2a4-cf41f74ca447","06/14/2022","when contentType name and id are returned from the server, use the value directly instead of reading it from the cache"),it=se.t.isActivated("ffb103bc-ed13-4e14-98a4-b0f6c573c8d6","08/24/2022","ensure update contentTypeInfo"),rt=function(e){function t(t,n){var a=e.call(this,{},n)||this;return a._clientForms=null,a._init=function(e,t){var n=t.pageContext,i=t.apiUrlHelper,r=t.itemUrlHelper;a._itemUrlHelper=r||new F.e({},{pageContext:n}),a._apiUrlHelper=i||new N.e({},{itemUrlHelper:a._itemUrlHelper,pageContext:n}),e.complianceTagProvider?a._complianceTagProvider=e.complianceTagProvider:a._complianceTagProvider=new Se({pageContext:n}),e.fileUploaderProvider?a._fileUploaderProvider=e.fileUploaderProvider:a._fileUploaderProvider=new fe({pageContext:n}),a.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return E.n.isFeatureEnabled(e,a._pageContext&&a._pageContext.ExpFeatures)},a.isFeatureEnabled(nt)&&a._pageContext.isLabelIRMEnabled&&(a._sensitivityLabelsDataSource=new He({},{pageContext:a._pageContext,getOAuthToken:null==t?void 0:t.getGraphAuthToken}))},a._getAdditionalPostData=function(e){return e.isListDataRenderOptionChangeFeatureEnabled=a.isFeatureEnabled(We),e.isSpotlightFeatureEnabled=a.isFeatureEnabled(qe),R.e(e)},a._init(t,n),a}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"listContext",{set:function(e){this._listContext=e},enumerable:!1,configurable:!0}),t.prototype.updateContext=function(e,t){this._init(e,t)},t.prototype.getClientFormSchema=function(e,t,n){var a,i=this,o=function(){var a=i._locateClientFormWithContentTypeInfos(e,t);if(n&&a&&a.fields){var o=a.fields.filter(function(e){return!i._isFieldRequireUniqueValue(e)});return Object(r.__assign)(Object(r.__assign)({},a),{fields:o})}return a};return 2===e&&t&&this._contentTypeIdToNameMap&&(a=this._contentTypeIdToNameMap[t[0].contentTypeId]),null===this._clientForms||this._listContext.refreshClientForm||!a?(this._listContext.refreshClientForm=void 0,this.fetchAllClientFormSchemas().then(function(){return o()})):O.t.wrap(o())},t.prototype.getClientForm=function(e,t,n,a){var i=this;return new O.t(function(r,o){i.getData(function(){var t=L.e.encodeRestUriStringToken(i._listContext.listUrl),n=new De.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",a=",cutoffVersion=".concat(n);return"".concat(i._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(30).concat(a,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData),n&&n.length>0&&!n[0].contentType&&t.ListData&&t.ListData.ContentType&&(n[0].contentType=t.ListData.ContentType,it||n[0].contentTypeId||(n[0].contentTypeId=t.ListData.ContentTypeId)),t.ListDataLite=t.ListData,t.ListData=t.Data,t.Data=void 0,t}return null},"GetItemDataForClientForm",function(){return""},"POST",i._getAdditionalHeaders()).then(function(e){var o;if(!a&&i.isFeatureEnabled(nt)&&i._pageContext.isLabelIRMEnabled)null===(o=i._sensitivityLabelsDataSource)||void 0===o||o.getDocLibSensitivityLabels().then(function(o){i._sensitivityLabelOptions=je.processLabelsForItem(o);var s=i._processGetClientFormServerData(e,t,n,a);r(s)}).catch(function(e){});else{var s=i._processGetClientFormServerData(e,t,n,a);r(s)}},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1;o({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})})},t.prototype.updatePanelViewInfo=function(e){var t=this;return new O.t(function(n,a){t.getData(function(){var n=L.e.encodeRestUriStringToken(t._listContext.listUrl);return"".concat(t._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/contentTypes('".concat(e.contentTypeId,"')")+"/ReorderFields()"+"?@v1='".concat(n,"'")},function(){return null},"CustomPanelSaveDataToServer",function(){return JSON.stringify({fieldNames:e.data})}).then(function(){n(e.serverResponse({message:{value:"updated Information"}}))},function(t){a(e.serverResponse(t))})})},t.prototype.saveCustomShowHideRules=function(e,t,n){var a=this,i={__metadata:{type:"SP.Field"},ClientValidationFormula:e.rules,ClientValidationMessage:e.errMsg};return this.getData(function(){return a._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",n).toString()},function(e){return e},"saveCustomValidationRules",function(){return JSON.stringify(i)},"MERGE")},t.prototype._isFieldRequireUniqueValue=function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"===t||"attachments"===t||"Title"===n||"LinkTitle"===n||"LinkTitleNoMenu"===n||"thumbnail"===t},t.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)},t.prototype.saveClientFormCustomFormatter=function(e,t){var n=this,a={__metadata:{type:"SP.ContentType"},ClientFormCustomFormatter:JSON.stringify(e.ClientFormCustomFormatterJson)};return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e.ContentTypeId+"')").toString()},function(e){return e},"saveCustomFormFormatterJSON",function(){return JSON.stringify(a)},"MERGE")},t.prototype.getClientFormCustomFormatter=function(e,t){var n=this;return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e+"')").toString()},function(e){return e},"GetCustomFormatter",null,"GET")},t.prototype.getResourceProviders=function(){return{ComplianceTagProvider:this._complianceTagProvider,FileUploaderProvider:this._fileUploaderProvider}},t.prototype._processGetClientFormServerData=function(e,t,n,a){var i=this,o=new re({listContext:this._listContext,pageContext:this._pageContext}).processData("parent",e),s=o&&o.items&&o.items[0];this._clientForms={};var c=e.ListSchema,d=e.ItemContentTypeId,l=it?e.ItemContentTypeName:e.ItemContentTypeName||e.ItemContentType,u=e.ClientFormCustomFormatter;u&&(this._ctIdToClientFormCustomFormatter=u),c&&(c.New&&this._processClientFormResponse(2,c.New,d,l),c.Edit&&(this._processClientFormResponse(1,c.Edit,d,l),this._processClientFormResponse(3,c.Edit,d,l)));var f=this._locateClientFormWithContentTypeInfos(t,n);if(a&&f&&f.fields){var p=f.fields.filter(function(e){return!i._isFieldRequireUniqueValue(e)});f=Object(r.__assign)(Object(r.__assign)({},f),{fields:p})}var m={item:s,formType:f.formType,contentType:f.contentType,contentTypeId:f.contentTypeId,fields:[],isBulkEdit:a,clientFormCustomFormatter:f.clientFormCustomFormatter};this._generateFieldsFromSchema(m,f);for(var _=[],h=0,b=m.fields;h<b.length;h++)0===(y=b[h]).state&&(y.state=2,_.push(y));2!==t&&this._handleServerData(m,e,{},_);for(var g=0,v=_;g<v.length;g++){var y;(y=v[g]).state=0}return m},t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&(this._listContext.enableAttachments||void 0===this._listContext.enableAttachments),a=0,i=t.fields.length;a<i;a++){var r=t.fields[a];("Attachments"!==r.Type||n)&&(!e.isBulkEdit||!r.ReadOnlyField)&&e.fields.push(this._generateField(e,r))}if(!e.isBulkEdit&&this.isFeatureEnabled(nt)&&this._pageContext.isLabelIRMEnabled&&this._sensitivityLabelOptions){var o=this._generateSensitivityLabelField(this._sensitivityLabelOptions);e.fields.push(this._generateField(e,o))}},t.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:0}},t.prototype._generateSensitivityLabelField=function(e){return{Id:"sensitivitylabel",Name:"Sensitivity",Type:"SensitivityLabel",Hidden:!1,InternalName:"sensitivitylabel",Title:"Sensitivity",SensitivityLabelOptions:e,FieldType:"sensitivitylabel"}},t.prototype.updateFormValues=function(e,t){var n=this,a=e.item;if(!a||!a.properties||!a.properties.ID)return O.t.wrap();for(var i=[],r=0,o=e.fields;r<o.length;r++){var s=o[r];0===s.state&&(s.state=2,i.push(s))}return this.getData(function(){var e=a.properties.ID,t=L.e.encodeRestUriStringToken(n._listContext.listUrl),i=new De.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",r=",cutoffVersion=".concat(i);return"".concat(n._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(15).concat(r,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders(),"",0,!0).then(function(a){n._handleServerData(e,a,t,i);for(var r=0,o=i;r<o.length;r++)o[r].state=0},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,a=0,r=i;a<r.length;a++)r[a].state=0;return O.t.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})},t.prototype.createItem=function(e){var t=this,n=this._getUrlInfo(),i=n.listUrl,r=n.itemUrlParts,o="AddValidateUpdateItemUsingPath",s=function(){return t._apiUrlHelper.build().webByItemUrl(r).method("GetList",i).method(o).toString()},c=!!e.clientForm.contentTypeId&&0===e.clientForm.contentTypeId.lastIndexOf(Ke,0),d=function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n},UnderlyingObjectType:c?"1":void 0},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(Ze)?t._doCreateItem(s,d,e,o):t._fileUploaderProvider&&t._fileUploaderProvider.hasPendingImageOperations()?t._updateImages(!0).then(function(n){var i=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});return t.handleFileUploaderErrors(n,null,i)?(n&&n.length>0&&n.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n){var a=ke(n.data);a&&(a.serverRelativeUrl=t.image.serverRelativeUrl,a.id=t.image.id,a.serverUrl=t.image.serverUrl);try{n.data=JSON.stringify(a)}catch(e){n.data=""}}}}),t._doCreateItem(s,d,e,o)):O.t.wrap({status:a.fail})}):t._doCreateItem(s,d,e,o)})},t.prototype._doCreateItem=function(e,t,n,i){var r=this;return this._createOrUpdateItem($e,e,t,n,i).then(function(e){return r._postUpdateFields($e,n,[]).then(function(t){return e.status===a.success&&t.status===a.fail?(t.status=a.partialSuccess,t):e})})},t.prototype.updateItem=function(e){var t=this,n=e.clientForm.isBulkEdit&&e.itemdIds&&e.itemdIds.length>1?e.itemdIds:void 0,i=n&&n.length>1,r=function(e){var n=t._getUrlInfo(),a=n.listUrl,r=n.itemUrlParts;return i?t._apiUrlHelper.build().webByItemUrl(r).method("GetList",a).method("BulkValidateUpdateListItems").toString():t._apiUrlHelper.build().webByItemUrl(r).method("GetList",a).method("items",e.properties.ID).method("ValidateUpdateListItem").toString()},o=function(a){var r;return i&&(r=t._listContext.folderPath),JSON.stringify({itemIds:n,formValues:a,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:r})};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(Ze)?t._doUpdateItem(r,o,e,i,n):t._fileUploaderProvider&&t._fileUploaderProvider.hasPendingImageOperations()?t._updateImages(!1).then(function(s){var c=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});return t.handleFileUploaderErrors(s,null,c)?(s&&s.length>0&&s.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n&&n.data!==n.serverData){var a=ke(n.data);a&&(a.serverRelativeUrl=t.image.serverRelativeUrl,a.id=t.image.id,a.serverUrl=t.image.serverUrl),n.data=a?JSON.stringify(a):""}}}),t._doUpdateItem(r,o,e,i,n)):O.t.wrap({status:a.fail})}):t._doUpdateItem(r,o,e,i,n)})},t.prototype._doUpdateItem=function(e,t,n,i,r){var o=this;return this._createOrUpdateItem(et,e,t,n,i?"BulkValidateUpdateListItems":"ValidateUpdateListItem",r).then(function(e){return o._postUpdateFields(et,n,r).then(function(t){return e.status===a.success&&t.status===a.fail?(t.status=a.partialSuccess,t):e})})},t.prototype.fetchAllClientFormSchemas=function(){var e=this;return this._clientFormsDebouncer||(this._clientFormsDebouncer=new k.e),this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return e._getServerConnectionUrl().toString()},function(t){e._clientForms={};var n=JSON.parse(t);n.ContentTypeIdToNameMap&&(e._contentTypeIdToNameMap=n.ContentTypeIdToNameMap),n.ClientFormCustomFormatter&&(e._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var a=n.ClientForms;a&&(a.New&&e._processClientFormResponse(2,a.New),a.Edit&&(e._processClientFormResponse(1,a.Edit),e._processClientFormResponse(3,a.Edit))),n.Navigation&&(e._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes}),e._listContext.enableAttachments="true"===n.EnableAttachments,n.FormRenderModes&&e._processFormRenderMode(n.FormRenderModes),(n.PowerAppFormId||n.AppId)&&(e._powerAppFormId=n.PowerAppFormId||n.AppId),n.AppRenderInfo&&(e._powerAppFormInfo=n.AppRenderInfo||{}),n.AppAdditionalData&&(e._powerAppAdditionalData=n.AppAdditionalData),n.CachedFileUrlTemplate&&n.CacheAppFiles&&(e._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){return e._getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:!1})},"POST",this._getAdditionalHeaders()))),this._clientFormsPromise},t.prototype.getFieldFilterData=function(e,t,n){return new j.e({parentKey:void 0,listContext:this._listContext,pageContext:this._pageContext,folderPath:n,itemUrlHelper:this._itemUrlHelper,apiUrlHelper:this._apiUrlHelper}).getFilterData(e,"",t,void 0)},t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t},t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})},t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})},t.prototype.getPowerAppFormId=function(){return this._powerAppFormId},t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo},t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData},t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo},t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return"".concat(t._pageContext.webAbsoluteUrl,"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='")+e+"'&visualizationTarget=1"},function(e){var t=JSON.parse(e),n="";return t.d&&t.d.Value&&(n=JSON.parse(t.d.Value)),n},"GetPowerAppFormDesignUrl",null,"GET")},t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return H.t({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})},t.prototype._processClientFormResponse=function(e,t,n,a){this._clientForms[e]||(this._clientForms[e]={});var i=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!i[r]){var o;o=at||r!==a?this._reverseLookupContentTypeIdByName(r):n;var s=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[o]:void 0;i[r]={contentType:r,contentTypeId:o,formType:e,fields:[],clientFormCustomFormatter:s?JSON.parse(s):void 0,mode:0};for(var c=i[r],d=t[r],l=0,u=d.length;l<u;l++)c.fields.push(d[l])}this._clientForms[e]=i},t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null},t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var a=2;switch(n){case"Edit":a=1;break;case"Display":a=3}var i=0;switch(e[t][n].RenderType){case 1:i=2;break;case 2:i=3;break;case 3:i=4;break;case 4:i=5;break;default:M.e.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[a][t].mode=i}},t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var n=t[0],a=this._locateClientForm(e,n.contentType,n.contentTypeId);if(1===t.length||!a||!a.fields)return a;for(var i=a.fields.slice(),o=function(n){if(0===i.length)return"break";var a=t[n],r=s._locateClientForm(e,a.contentType,a.contentTypeId);i=i.filter(function(e){for(var t=0,n=r.fields;t<n.length;t++)if(n[t].Name===e.Name)return!0;return!1})},s=this,c=1;c<t.length&&"break"!==o(c);c++);return Object(r.__assign)(Object(r.__assign)({},a),{fields:i})},t.prototype._locateClientForm=function(e,t,n){if(!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]),!t&&this._clientForms[e])for(var a in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(a)){t=a;break}if(n&&0===n.lastIndexOf(Ke,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var a in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(a)){var r=this._clientForms[e][a].fields.filter(function(e){return!!i[e.Name]})[0];if(r)return this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[r],mode:0},this._clientForms[e].Folder}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var a in this._clientForms[e])if(this._clientForms[e][a]&&!this._clientForms[e][a].contentTypeId)return this._clientForms[e][a];return null}return this._clientForms[e][t]},t.prototype._getAdditionalHeaders=function(e,t){var n=H.a(this._listContext);return this.isFeatureEnabled(Xe)&&n&&e&&(2===e?(n.Scenario="CreateListItem",n.ScenarioType="AUO"):1===e&&(n.Scenario="EditListItem",n.ScenarioType="AUO")),t&&(n.nucleusRedirection="false"),n},t.prototype._handleServerData=function(e,t,n,a){var i=t.ListDataLite?t.ListDataLite:t.ListData,r=t.ListDataLite?t.ListData.Row[0]:t.Data.Row[0],o=e.item;this._ctIdToClientFormCustomFormatter=t.ClientFormCustomFormatter,this.isFeatureEnabled(nt)&&this._pageContext.isLabelIRMEnabled&&(e.sensitivityLabel=t.ListData.Row&&t.ListData.Row[0]&&t.ListData.Row[0]._DisplayName);for(var s=0,c=a.length;s<c;s++){var d=a[s],l=d.schema;if(!n||!n.hasOwnProperty(l.Name)){if(void 0===d.data&&(d.data=null),void 0===d.serverData&&(d.serverData=null),i.hasOwnProperty(l.Name)){if(l.FieldType&&"boolean"===l.FieldType.toLowerCase()&&""===r[l.Name]&&"0"===i[l.Name]?d.serverData="":l.FieldType&&"thumbnail"===l.FieldType.toLowerCase()&&r[l.Name]?d.serverData=r[l.Name]:d.serverData=i[l.Name],o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=r[l.Name]),this.isFeatureEnabled(Je)&&(o.properties.hasOwnProperty("ItemExpirationDate")||(o.properties.ItemExpirationDate=r._ExpirationDate),!o.properties.hasOwnProperty("IsItemExpirationModifiable"))){var u=r.MetaInfo,f=u&&u[0]&&u[0].lookupValue||"",p=new RegExp(/vti_stream_isexpirationmodifiable:([a-zA-Z]{2})\|false/gi).test(f);o.properties.IsItemExpirationModifiable=!p}}else ve(d)?(d.serverData=r._ComplianceTag,o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=r[l.Name])):o.folder&&d.schema.FieldType&&"file"===d.schema.FieldType.toLowerCase()&&d.schema.Title&&"name"===d.schema.Title.toLowerCase()&&i.Title?d.serverData=i.Title:l.FieldType&&"sensitivitylabel"===l.FieldType?d.serverData=e.sensitivityLabel:d.serverData=null;e.isBulkEdit&&(d.serverData=null),d.schema.AppendOnly?(d.appendOnlyData=t[d.schema.Name],d.data=""):d.schema.SensitivityLabelOptions?d.data="":d.data=d.serverData}}o.hasClientFormData=!0},t.prototype._createOrUpdateItem=function(e,t,n,i,r,o){var s=this,c=i.clientForm.fields,d=[],l=[],u={},f=[],p=!1,m=!1;1===i.clientForm.formType&&i.clientForm.item&&!i.clientForm.isBulkEdit&&this._listContext&&!this._listContext.isDocLib&&i.clientForm.item.properties&&"1"===i.clientForm.item.properties.FSObjType&&(m=!0),this.isFeatureEnabled(Ye)&&(o?Ce(i.clientForm,o.length):Ce(i.clientForm));for(var _=void 0,h=!1,b=!1,g=0,v=c;g<v.length;g++){var y=v[g];if(this.isFeatureEnabled(Ze)&&"thumbnail"===y.schema.FieldType.toLowerCase()&&(b=!0),null!==y.data&&void 0!==y.data){var S=y.data;if("thumbnail"===y.schema.FieldType.toLowerCase()){if(this.isFeatureEnabled(Ze))continue;if("string"!=typeof S)try{S=JSON.stringify(S)}catch(e){}}if(!this._isClientFormFieldUpdated(i,S,y.serverData,y)||"attachments"===y.schema.FieldType.toLowerCase()||"sensitivitylabel"===y.schema.FieldType||ve(y)||ge(y))u[y.schema.Name]=!0,tt||_||!this._isEventField(y)||(_=y);else{d.push(y);var D=y.schema.Name;"ContentType"===D&&(S=this._reverseLookupContentTypeIdByName(S.displayName),D="ContentTypeId",p=!0),l.push({FieldName:D,FieldValue:S,HasException:!1,ErrorMessage:null}),tt||h||!this._isEventField(y)||(h=!0),"Title"===D&&m&&l.push({FieldName:"FileLeafRef",FieldValue:S,HasException:!1,ErrorMessage:null});var I=y.schema.FieldType.toLowerCase();le.e.logData({name:"ClientFormUpdate",extraData:{FieldType:I,Host:Ee()}})}}}if(!tt&&h&&_&&l.push({FieldName:_.schema.Name,FieldValue:_.data,HasException:!1,ErrorMessage:null}),p?4096==(4096&this._listContext.flags2)&&l.push({FieldName:"PrimeCorrectedByUser",FieldValue:"true",HasException:!1,ErrorMessage:null}):2===i.clientForm.formType?l.push({FieldName:"ContentType",FieldValue:i.clientForm.contentType,HasException:!1,ErrorMessage:null}):1===i.clientForm.formType&&i.clientForm.item&&i.clientForm.item.properties&&!i.clientForm.isBulkEdit&&l.push({FieldName:"ContentTypeId",FieldValue:i.clientForm.item.properties.ContentTypeId,HasException:!1,ErrorMessage:null}),0===d.length&&0===f.length)return O.t.wrap({status:a.success});var x=!1;return this.isFeatureEnabled(Ze)&&2===i.clientForm.formType&&b&&(x=!0),f.push(this._getUpdateItemPromise(e,t,n,i,r,d,l,i.clientForm.item,o,x)),O.t.all(f).then(function(e){for(var t={status:a.success},n=0,i=e;n<i.length;n++){var r=i[n];r&&r.hasOwnProperty("status")&&(t.status=r.status,r.failedItemIds&&(t.failedItemIds=r.failedItemIds));break}return t},function(e){var t,n;if((e=Array.isArray(e)?e:[e])&&e[0]&&e[0].code){var a=e[0].code.split(", ");a&&2===a.length&&(t=a[0],n=a[1])}for(var r="-2146232832"===t&&"Microsoft.SharePoint.SPFieldValidationException"===n,o=0;o<d.length;o++){var c=d[o];c.hasException=0===o||r,c.state=0}var l=Object(B.a)(s._pageContext)+i.clientForm.item.properties.FileRef;throw e.filter(function(e){return e&&e.message&&e.message.value}).map(function(e){return e.message.value=e.message.value.replace('"'.concat(l,'" '),""),e})})},t.prototype._isEventField=function(e){var t,n,a=null===(n=null===(t=e.schema)||void 0===t?void 0:t.Id)||void 0===n?void 0:n.toLowerCase();return"64cd368d-2f95-4bfc-a1f9-8d4324ecb007"===a||"2684f9f2-54be-429f-ba06-76754fc056bf"===a},t.prototype._getUpdateItemPromise=function(e,t,n,i,r,o,s,c,d,l){var u=this;return s&&0!==s.length&&o&&0!==o.length?this.getData(t.bind(null,c),function(e){var t=JSON.parse(e);if(!t.d||!t.d[r]||!t.d[r].results){for(var n=0,s=o;n<s.length;n++)(E=s[n]).state=0;return O.t.wrapError("The server response couldn't be processed")}for(var l=null,f={},p="",m=0,_=t.d[r].results;m<_.length;m++){var h=_[m];if(2===i.clientForm.formType&&"Id"===h.FieldName){var b=c;b.properties||(b.properties={}),b.properties.ID=h.FieldValue}if(!0===h.HasException||null!==h.ErrorMessage){var g=h.FieldName;if(f[g]||(f[g]=[]),void 0!==h.ItemId&&f[g].indexOf(h.ItemId)<0&&f[g].push(h.ItemId),!l){l={};for(var v=0,y=i.clientForm.fields;v<y.length;v++){var S=y[v];l[S.schema.Name]=S}}if(l[g]){l[g].errorMessage=h.ErrorMessage,l[g].hasException=!0;var D=l[g].schema.Title;p=p?p+", "+D:D}}}var I={status:p?a.fail:a.success};if(d&&d.length&&f.null){var x=f.null;x.length<d.length?I.status=a.partialSuccess:I.status=a.fail,I.failedItemIds=x}for(var C=0,w=o;C<w.length;C++){var E=w[C];p?!f[E.schema.Name]&&i.isInteractiveSave&&(E.errorMessage="Cannot save due to errors in other fields: "+p,E.hasException=!0):(E.errorMessage="",E.hasException=!1),E.state=0}return u._raiseCreateOrUpdateEvents(i,I),I},e,function(){return n(s)},"POST",this._getAdditionalHeaders(i.clientForm.formType,l),void 0,5):O.t.wrap()},t.prototype._getUrlInfo=function(){var e=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return{listUrl:e&&e.serverRelativeListUrl?e.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:e}},t.prototype._isClientFormFieldUpdated=function(e,t,n,a){return!(e.clientForm.isBulkEdit&&""===t&&null===n||a.schema.AppendOnly&&!t&&!Object(ne.i)(this._pageContext.listBaseTemplate)||("thumbnail"===a.schema.FieldType.toLowerCase()?a.data.fileName&&n.fileName&&a.data.serverRelativeUrl===n.serverRelativeUrl:P.e(t,n)))},t.prototype._postUpdateFields=function(e,t,n){var i=this,r=t.clientForm,o=r.item;if(!this.isValidItem(o))return O.t.wrap({status:a.fail});for(var s=this._itemUrlHelper.getItemUrlParts(o.key).serverRelativeListUrl,c=n&&n.length>1,d=[],l=null,u=null,f=[],p=0;p<r.fields.length;p++){var m=r.fields[p];if(ve(m)){if(!c&&m.data===m.serverData)continue;if(c){var _=this._updateMultipleComplianceTagsPromises(n,m,s);if(_)for(var h=0,b=_;h<b.length;h++){var g=b[h];d.push(g)}}else d.push(this._updateComplianceTagField(m,o));le.e.logData({name:"ClientFormUpdate."+m.schema.FieldType.toLowerCase()})}else if(ge(m)){if(!this.isFeatureEnabled(Qe)||m.data===m.serverData)continue;var v=me(o.properties._ComplianceFlags);if(v===("1"===m.data)||c)continue;d.push(this._updateUnlockRecordField(o,m,s,v)),le.e.logData({name:"ClientFormUpdate."+m.schema.FieldType.toLowerCase()})}else if("attachments"===m.schema.FieldType.toLowerCase())l=m;else if("sensitivitylabel"===m.schema.InternalName)u=m;else if("thumbnail"===m.schema.FieldType.toLowerCase()){if(!m.data&&!m.serverData)continue;if(m.data&&m.serverData&&m.data.serverRelativeUrl===m.serverData.serverRelativeUrl)continue;f.push(m)}}if(this.isFeatureEnabled(nt)&&this._pageContext.isLabelIRMEnabled&&u){var y=t.graph,S=null==y?void 0:y.driveId,D=null==y?void 0:y.itemId,I=this._getCurrentSensitivityLabelTitle(this._sensitivityLabelOptions,u.data);u.data!==I&&S&&D&&(le.e.logData({name:"ClientFormSensitivityLabelUpdate",extraData:{Host:Ee()}}),d.push(O.t.resolve(this._sensitivityLabelsDataSource.setSensitivityLabel(S,D,u.data,u.justificationText).then(function(e){return r.sensitivityLabel=I,{status:a.success}},function(e){var t=e.message;return e.innerError&&(t=t+"."+e.innerError.message),u.errorMessage=t,{status:a.fail}}))))}return n&&0!==n.length||(d.push(this._updateAttachmentsField(l,o,e)),this.isFeatureEnabled(Ze)&&d.push(this._updateThumbnailFields(f,o,e===$e))),O.t.all(d).then(function(e){var t;f.length>0&&i._pageContext.dataSyncClient&&i._pageContext.listId&&i._pageContext.siteId&&i._pageContext.dataSyncClient.then(function(e){e&&e.triggerListSyncNowForCurrentUser({listId:Object(Ge.normalizeLower)(i._pageContext.listId,!1),siteId:Object(Ge.normalizeLower)(i._pageContext.siteId,!1)})});for(var n={status:a.success},r=0,o=e;r<o.length;r++){var s=o[r];s&&s.status===a.fail&&(n.status=s.status),s&&s.failedItemIds&&s.failedItemIds.length>0&&(t=n.failedItemIds).push.apply(t,s.failedItemIds)}return n})},t.prototype._getCurrentSensitivityLabelTitle=function(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return e[n].text;return""},t.prototype._updateComplianceTagField=function(e,t){var n,i=e.schema;return i.ComplianceTags&&(n=i.ComplianceTags.filter(function(t){return t&&t.tagValue===e.data})[0]),n?(e.state=1,this._complianceTagProvider.updateComplianceTag(t,n).then(function(){return e.state=0,{status:a.success}},function(t){return t&&e&&(e.errorMessage=t.message&&t.message.value?t.message.value:t,e.hasException=!0),e.state=0,{status:a.fail}})):O.t.wrap(null)},t.prototype._updateMultipleComplianceTagsPromises=function(e,t,n){var i,r=t.schema,o=[];if(r.ComplianceTags&&(i=r.ComplianceTags.filter(function(e){return e&&e.tagValue===t.data})[0]),!i)return o;t.state=1;for(var s=[],c=0,d=0,l=e.length;d<l;d++)s.push(e[d]),200!=++c&&d!==e.length-1||(o.push(this._complianceTagProvider.updateComplianceTagInBatch(s,i,n).then(function(e){return t.state=0,e&&e.length>0?{status:a.fail,failedItemIds:e}:{status:a.success}},function(e){return e&&t&&(t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=0,{status:a.fail,failedItemIds:s}})),s=[],c=0);return o},t.prototype._updateUnlockRecordField=function(e,t,n,i){var r="1"===t.data;return t.state=1,r?this._complianceTagProvider.unlockRecord(e,n).then(function(e){return t.serverData=e?"1":"0",t.state=0,{status:a.success}},function(e){return e&&t&&(t.serverData=i?"1":"0",t.data="0",t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=0,{status:a.fail}}):this._complianceTagProvider.lockRecord(e,n).then(function(e){return t.serverData=e?"1":"0",t.state=0,{status:a.success}},function(e){return e&&t&&(t.serverData=i?"1":"0",t.data="1",t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=0,{status:a.fail}})},t.prototype._updateAttachmentsField=function(e,t,n){var i=this;return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingAttachmentOperations()?(e.state=1,this._fileUploaderProvider.executeAttachmentOperations(n===$e&&t&&t.properties?Number(t.properties.ID):void 0).then(function(t){return i._fileUploaderProvider.clearAttachmentOperations(),{status:i.handleFileUploaderErrors(t,e,[])?a.success:a.fail}},function(t){return i._fileUploaderProvider.clearAttachmentOperations(),{status:i.handleFileUploaderErrors(t,e,[])?a.success:a.fail}})):O.t.wrap(null)},t.prototype.isValidItem=function(e){return e&&e.properties&&e.properties.ID&&"0"!==e.properties.ID},t.prototype.handleFileUploaderErrors=function(e,t,n){var a={attachments:[]},i=!0;if(e.forEach(function(e){e.result||(e.attachment&&a.attachments.push(e.errorMsg),e.image&&(a[e.image.fieldName]=e.errorMsg),i=!1)}),t){if(a.attachments.length>0){var r=a.attachments.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage=r,t.hasException=!0}t.state=0,le.e.logData({name:"ClientFormUpdate."+t.schema.FieldType.toLowerCase()})}return n.forEach(function(e){a[e.schema.Name]&&(e.errorMessage=a[e.schema.Name],e.hasException=!0),e.state=0,le.e.logData({name:"ClientFormUpdate."+e.schema.FieldType.toLowerCase()})}),i},t.prototype._ensureClientForms=function(e){return this._clientForms&&this._contentTypeIdToNameMap&&!this._listContext.refreshClientForm?e?O.t.wrap(e()):O.t.wrap():(this._listContext.refreshClientForm=void 0,e?this.fetchAllClientFormSchemas().then(e):this.fetchAllClientFormSchemas().then(function(){return O.t.wrap()}))},t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1},t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],a=this._clientForms[e][n];return a?a.mode:this._checkRenderModes(4)?4:0},t.prototype._raiseCreateOrUpdateEvents=function(e,t){var n=e.clientForm;if(t&&t.status===a.success&&n){var i=n.item&&n.item.properties&&n.item.properties.ID?n.item.properties.ID:void 0,r=e.itemdIds&&e.itemdIds.length?e.itemdIds.map(String):i?[i]:void 0;r&&Ae.t.raise(window,2===n.formType?Le.newItemCreated:Le.itemUpdated,{itemIds:r})}},t.prototype._updateImages=function(e){return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations()?this._fileUploaderProvider.executeImageOperationsOnSingleItem(e?0:void 0,void 0,e):O.t.wrap([])},t.prototype._updateThumbnailFields=function(e,t,n){var i=this;return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations()?this._fileUploaderProvider.executeImageOperationsOnSingleItem(Number(t.properties.ID),void 0,n).then(function(t){return{status:i.handleFileUploaderErrors(t,null,e)?a.success:a.fail}},function(t){return{status:i.handleFileUploaderErrors(t,null,e)?a.success:a.fail}}):O.t.resolve()},t}(T.t),ot="Folder",st={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},ct=function(){function e(e,t){var n=this;this._buffer=[],this._bufferSize=5,this._init=function(e,t){var a,i;t&&t.pageContext?(n._pageContext=t.pageContext,n._listContext=t.listContext,a=t.apiUrlHelper,i=t.itemUrlHelper):(n._pageContext=e.pageContext,n._listContext=e.listContext,a=e.apiUrlHelper,i=e.itemUrlHelper,n._defaultValueOverride=e.defaultValueOverride||{});var r={isFeatureEnabled:e.isFeatureEnabled,fileUploaderProvider:e.fileUploaderProvider,complianceTagProvider:e.complianceTagProvider},o={pageContext:n._pageContext,apiUrlHelper:a,itemUrlHelper:i,getGraphAuthToken:null==e?void 0:e.getGraphAuthToken};n._clientFormDataSource?n._clientFormDataSource.updateContext(r,o):n._clientFormDataSource=new rt(r,o),n._clientFormDataSource.listContext=n._listContext,n.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return E.n.isFeatureEnabled(e,n._pageContext&&n._pageContext.ExpFeatures)}},this._getStoredClientFormId=function(e,t,n){return e+"|"+t+"|"+n},this._getClientFormData=function(e){if(e.status===i.pending){var t=new A.e;return e.onFinish=function(n){n=e.status||n,t.complete(e.clientForm)},t.getPromise()}return O.t.resolve(e.clientForm)},this._init(e,t)}return e.prototype.updateContext=function(e,t){this._init(e,t)},e.prototype.getClientForm=function(e,t,n){var a,r,o=this;void 0===t&&(t=!1),void 0===n&&(n=!1),t&&(this._listContext.refreshClientForm=!0);var s,c,d=e.itemId,l=e.item;if(!d&&l){var u=this._getBufferKeyFromItem(l,e.contentType);if(s=e.isBulkEdit?void 0:this._getClientFormFromBuffer(u),l.type!==w.e.Folder||e.contentType||(e.contentType=ot),s){if(l.hasClientFormData)return s.item=e.item,O.t.wrap(s);this._deleteClientFormFromBuffer(u)}}var f=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var p={},m=0,_=e.selection;m<_.length;m++){var h=_[m];if(h){var b=h.properties;if(b){var g=(S=h.type!==w.e.Folder||b.ContentType?b.ContentType:ot)+(v=b.ContentTypeId);p[g]||(f.push({contentType:S,contentTypeId:v}),p[g]=!0)}}}else f.push({contentType:e.contentType,contentTypeId:e.contentTypeId});if(d){var v,y=e.isBulkEdit,S=e.contentType,D=e.clientFormType,I=(v=e.contentTypeId)&&0===v.lastIndexOf(Ke,0),x="Media.Meeting"===(null===(r=null===(a=null==e?void 0:e.item)||void 0===a?void 0:a.properties)||void 0===r?void 0:r.ProgId)&&n&&!y&&!I;if(this.isFeatureEnabled(st)&&x){var C=this._getStoredClientFormId(d,S,y),E=this._getStoredClientForm(C);return E&&void 0!==E.status?this._getClientFormData(E).then(function(e){return o._deleteClientFormFromStoredClientForm(C),e}):(this._completeStoredClientForm(E,i.pending),this._clientFormDataSource.getClientForm(d,D,f,y).then(function(e){return o._completeStoredClientForm(E,i.success,e),e}))}return this._clientFormDataSource.getClientForm(d,e.clientFormType,f,e.isBulkEdit)}return this._clientFormDataSource.getClientFormSchema(e.clientFormType,f).then(function(t){if(e.item&&!e.item.properties.ContentTypeId&&(e.item.properties.ContentTypeId=t.contentTypeId,e.item.properties.ContentType=t.contentType),c={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit},o._generateFieldsFromSchema(c,t),2!==e.clientFormType)return o.updateFormValues(c)}).then(function(){return o._addClientFormToBuffer(c),O.t.wrap(c)})},e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)},e.prototype.updateItem=function(t){return t.clientForm.isBulkEdit&&t.itemdIds&&(this._buffer=[],e._clientFormStore=[]),this._clientFormDataSource.updateItem(t)},e.prototype.saveCustomShowHideRules=function(e,t,n){return this._clientFormDataSource.saveCustomShowHideRules(e,t,n)},e.prototype.saveClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.saveClientFormCustomFormatter(e,t)},e.prototype.getClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.getClientFormCustomFormatter(e,t)},e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)},e.prototype.getFieldFilterData=function(e,t,n){return this._clientFormDataSource.getFieldFilterData(e,t,n)},e.prototype.getClientFormSchema=function(e,t,n){return this._clientFormDataSource.getClientFormSchema(e,[{contentType:t,contentTypeId:n}])},e.prototype.updatePanelViewInfo=function(e){return this._clientFormDataSource.updatePanelViewInfo(e)},e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)},e.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},a=0,i=e.selection;a<i.length;a++){var r=i[a];if(r){var o=r.properties;if(o){var s=r.type!==w.e.Folder||o.ContentType?o.ContentType:ot,c=o.ContentTypeId,d=s+c;n[d]||(t.push({contentType:s,contentTypeId:c}),n[d]=!0)}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t},e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)},e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)},e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()},e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()},e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()},e.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()},e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)},e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()},e.prototype.clearBuffer=function(){this._buffer=[]},e.prototype.updateListContext=function(e){this._listContext=e,this._clientFormDataSource.listContext=e},e.prototype.getResourceProviders=function(){return this._clientFormDataSource.getResourceProviders()},e.prototype.updateDefaultValueOverride=function(e){this._defaultValueOverride=e},e.prototype.clearStoreClientForm=function(){e._clientFormStore=[]},e.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,a=0,i=t.fields.length;a<i;a++){var r=t.fields[a];void 0!==this._defaultValueOverride[r.InternalName]&&(r.DefaultValue=this._defaultValueOverride[r.InternalName],r.DefaultValueFormatted="",r.DefaultValueTyped=""),("Attachments"!==r.Type||n)&&(!e.isBulkEdit||!r.ReadOnlyField)&&e.fields.push(this._generateField(e,r))}},e.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:0}},e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t},e.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var a=this._buffer[t].key;if(a===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;return this._buffer.splice(t,1),this._buffer.unshift({key:a,form:i}),i}}return null},e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit){var t=e.item;t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}},e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++)if(this._buffer[t].key===e){this._buffer.splice(t,1);break}},e.prototype._getStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++)if(e._clientFormStore[n].clientFormId===t)return e._clientFormStore[n];var a={onFinish:void 0,clientFormId:t,clientForm:void 0,status:void 0};return e._clientFormStore.push(a),a},e.prototype._deleteClientFormFromStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++)if(e._clientFormStore[n].clientFormId===t){e._clientFormStore.splice(n,1);break}},e.prototype._completeStoredClientForm=function(t,n,a){for(var i=0;i<e._clientFormStore.length;i++)e._clientFormStore[i].clientFormId===t.clientFormId&&(e._clientFormStore[i].status=n,a&&(e._clientFormStore[i].clientForm=a),t.onFinish&&t.onFinish(n))},e._clientFormStore=[],e}(),dt=n(209);function lt(e){if(!e)return"";var t=e/1e7,n=Math.floor(t/3600),a=Math.floor((t-3600*n)/60),i=Math.round(t-3600*n-60*a),r=n<10?"0"+n:n;return(r+=":"+(a<10?"0"+a:a))+":"+(i<10?"0"+i:i)}function ut(e,t,n,a){var i,o,s,c,d,l,u,f,p,m;return Object(r.__awaiter)(this,void 0,void 0,function(){var _,h,b,g,v,y,S,D,I,O,w,E,A,L,k,M,P;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return void 0===e.driveItemKey||void 0===e.eTag?[3,11]:(_=Object(x.e)(e.driveItemKey),h="".concat(_,"/thumbnails/0/c").concat(90,"x").concat(150,"/content?").concat(Object(C.e)({prefer:"noredirect,closestavailablesize",cb:e.eTag})),b={UniqueId:e.uniqueId,Id:e.listItemId,WebAbsoluteUrl:null===(i=e.spItemKey)||void 0===i?void 0:i.webAbsoluteUrl,ListFullUrl:null===(o=e.spItemKey)||void 0===o?void 0:o.listFullUrl,WebDavUrl:e.webDavUrl},g=null===(s=e.fileName)||void 0===s?void 0:s.name,v=null===(d=null===(c=e.rowData)||void 0===c?void 0:c.Editor)||void 0===d?void 0:d[0],y=null!==(f=null===(u=null===(l=e.rowData)||void 0===l?void 0:l.Author)||void 0===u?void 0:u[0])&&void 0!==f?f:v,S=[],y&&(D={email:y.email,name:y.title,userId:y.email,isResolved:!0,Key:"i:0#.f|membership|"+y.email,DisplayText:y.title},S.push(D)),I=a||{listTitle:null==t?void 0:t.title,listId:null==t?void 0:t.id,flags2:null==t?void 0:t.flags2,listUrl:null==n?void 0:n.listUrl,isDocLib:null==t?void 0:t.isDocumentLibrary,contentTypesEnabled:null==t?void 0:t.contentTypesEnabled,enableAttachments:null==t?void 0:t.enableAttachments,allowCreateFolder:null==t?void 0:t.allowCreateFolder,tenantTagPolicyEnabled:null==t?void 0:t.tenantTagPolicyEnabled},O=new ct({pageContext:n,listContext:I}),w=void 0,(w={key:"newitem"}).properties={},[4,O.getClientForm({clientFormType:2,item:w})]);case 1:(E=r.sent()).fields.forEach(function(t){switch(t.schema.Name.toLowerCase()){case"thumbnail":t.data=h;break;case"title":t.data=g;break;default:break;case"owner":t.data=JSON.stringify(S);break;case"duration":t.data=function(e){try{var t=function(e){var t,n,a=null!==(t=null==e?void 0:e.MediaServiceFastMetadata)&&void 0!==t?t:'""',i=a?JSON.parse(a):{};if(i)return null===(n=i.media)||void 0===n?void 0:n.duration}(e);if(t)return lt(t);var n=function(e){var t,n=null!==(t=null==e?void 0:e.MetaInfo[0].lookupValue)&&void 0!==t?t:"";if(n){var a=n.substring(n.search("MediaServiceMediaDuration")+'MediaServiceMediaDuration":'.length);return Number(a.match(/^\d+/g))||(a=n.substring(n.search("duration")+'duration":'.length),Number(a.match(/^\d+/g)))}}(e);if(!n)throw new dt.e({code:"ItemDurationNotFound",errorData:{code:"Item duration not found",message:{lang:"",value:"MediaDuration not found in metaInfo and MediaServiceFastMetadata"},status:404},isExpected:!1});return lt(n)}catch(e){return Ie.e.logError(e),""}}(e.rowData)}}),A={data:JSON.stringify(b),hasException:!1,errorMessage:"",state:0,schema:{Name:"VideoIdentifiers",Type:"Text",Hidden:!0,FieldType:"Text"}},E.fields.push(A),L={clientForm:E,newDocumentUpdate:!1,checkInComment:void 0},r.label=2;case 2:r.trys.push([2,10,,11]),r.label=3;case 3:return r.trys.push([3,5,,9]),[4,O.createItem(L)];case 4:return r.sent(),[3,9];case 5:return(k=r.sent())instanceof Array&&(null===(p=k[0])||void 0===p?void 0:p.code)&&"-2130575276, Microsoft.SharePoint.SPException"===(null===(m=k[0])||void 0===m?void 0:m.code)?(L.clientForm.fields=L.clientForm.fields.filter(function(e){return"owner"!==e.schema.Name.toLowerCase()},void 0),[4,O.createItem(L)]):[3,7];case 6:return r.sent(),[3,8];case 7:throw k;case 8:return[3,9];case 9:return[3,11];case 10:throw(M=r.sent())instanceof Error?M:M instanceof Array?(P=M[0],new dt.e({errorData:P})):(P=M,new dt.e({errorData:P}));case 11:return[2]}})})}se.t.isActivated("01bff8fc-8bb0-41e1-bf75-daf9a5562ef5","11/23/2022","MediaDuration error in playlist");var ft=n(92),pt=n(1131),mt=Object(o.i)({maxParallelOperationCount:8})(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,a,i,o,x,C,O,w,E,A,L,k;return Object(r.__generator)(this,function(M){switch(M.label){case 0:n=new p.e({name:"StreamPlaylist.AddItemToPickedPlaylistOperation"}),M.label=1;case 1:return M.trys.push([1,10,,11]),[4,t(Object(c.e)(function(t){return t.demandItem({driveItemKey:d.e,webDavUrl:l.i,listItemId:u.Ce,fileName:l.f,rowData:u.at,spItemKey:s.e,eTag:l.u,spListKey:f.e,uniqueId:u.Nt},e.options.itemKey)}))];case 2:return a=M.sent(),[4,t(Object(c.e)(function(t){return t.demandItem({listTitle:l.l,listUrl:l.i},e.itemKey)}))];case 3:return i=M.sent(),o={listTitle:i.listTitle,listUrl:(null==i?void 0:i.listUrl)?Object(I.e)(null==i?void 0:i.listUrl):"",isDocLib:!1,contentTypesEnabled:!0,enableAttachments:!1,allowCreateFolder:!1,tenantTagPolicyEnabled:!1},void 0===a.driveItemKey?[3,8]:[4,t(Object(c.e)(function(t){return{pageContext:Object(b.e)(t,e.options.itemKey),listFacets:Object(g.e)(t,e.options.itemKey)}}))];case 4:return x=M.sent(),C=x.pageContext,O=x.listFacets,void 0===C||void 0===O?[3,6]:(w=C,E=s.e.deserialize(e.itemKey).webAbsoluteUrl,C.siteAbsoluteUrl!==E&&(w=Object(r.__assign)(Object(r.__assign)({},C),{webAbsoluteUrl:E,getAuthToken:function(){return t(Object(ft.e)({url:E}))}})),[4,ut(a,O,w,o)]);case 5:return M.sent(),n.end({resultType:m.e.Success}),t(Object(h.e)({items:(k={},k[e.itemKey]=[_.t],k)})),[3,7];case 6:throw new v.e({code:"MissingPageOrListContext",message:y.e,isExpected:!1});case 7:return[3,9];case 8:throw new v.e({code:"MissingDriveItemKey",message:y.e,isExpected:!1});case 9:return n.end({resultType:m.e.Success}),t(Object(S.e)({name:"StreamPlaylist.AddItemToPickedPlaylistOperationSuccess"})),[3,11];case 10:throw(A=M.sent()).code=A&&A.code?A.code:"SavePickedItemToPlaylistServerError",n.end(Object(D.e)(A)),L=A&&A.errorData&&403===A.errorData.status?pt.e:pt.n,new v.e({code:A&&A.code?A.code:"SavePickedItemToPlaylistServerError",message:L});case 11:return[2]}})})}})}}]);